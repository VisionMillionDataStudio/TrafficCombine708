# äº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†æ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunmasj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://kdocs.cn/l/cszuIiCKVNis)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€åŸå¸‚åŒ–è¿›ç¨‹çš„åŠ å¿«ï¼Œäº¤é€šç®¡ç†çš„å¤æ‚æ€§ä¸æ–­å¢åŠ ï¼Œäº¤é€šå®‰å…¨é—®é¢˜æ—¥ç›Šçªå‡ºã€‚äº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†ä½œä¸ºé“è·¯äº¤é€šç®¡ç†çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæ‰¿æ‹…ç€å¼•å¯¼å’Œè§„èŒƒé©¾é©¶è¡Œä¸ºçš„å…³é”®ä½œç”¨ã€‚ç„¶è€Œï¼Œä¼ ç»Ÿçš„äº¤é€šæ ‡å¿—è¯†åˆ«æ–¹æ³•å¾€å¾€ä¾èµ–äºäººå·¥æ£€æµ‹ï¼Œæ•ˆç‡ä½ä¸‹ä¸”å®¹æ˜“å—åˆ°ç¯å¢ƒå› ç´ çš„å½±å“ï¼Œéš¾ä»¥æ»¡è¶³ç°ä»£æ™ºèƒ½äº¤é€šç³»ç»Ÿçš„éœ€æ±‚ã€‚å› æ­¤ï¼ŒåŸºäºè®¡ç®—æœºè§†è§‰å’Œæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„è‡ªåŠ¨åŒ–æ£€æµ‹ç³»ç»Ÿåº”è¿è€Œç”Ÿï¼Œæˆä¸ºæå‡äº¤é€šå®‰å…¨å’Œç®¡ç†æ•ˆç‡çš„é‡è¦æ‰‹æ®µã€‚

YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹å› å…¶é«˜æ•ˆçš„å®æ—¶ç›®æ ‡æ£€æµ‹èƒ½åŠ›è€Œå—åˆ°å¹¿æ³›å…³æ³¨ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–äº†æ£€æµ‹ç²¾åº¦å’Œé€Ÿåº¦ï¼Œé€‚ç”¨äºå¤æ‚çš„äº¤é€šåœºæ™¯ã€‚é€šè¿‡æ”¹è¿›YOLOv8æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªé«˜æ•ˆçš„äº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†æ£€æµ‹ç³»ç»Ÿï¼Œæ—¨åœ¨æé«˜äº¤é€šæ ‡å¿—çš„è¯†åˆ«ç‡å’Œå“åº”é€Ÿåº¦ï¼Œä»è€Œä¸ºæ™ºèƒ½äº¤é€šç³»ç»Ÿçš„å»ºè®¾æä¾›æŠ€æœ¯æ”¯æŒã€‚

æœ¬ç ”ç©¶æ‰€ä½¿ç”¨çš„æ•°æ®é›†â€œTrafficCombineâ€åŒ…å«1900å¼ å›¾åƒï¼Œæ¶µç›–äº†6ç±»äº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†ï¼ŒåŒ…æ‹¬å‡é€Ÿå¸¦ã€æ–‘é©¬çº¿ã€ç¦æ­¢æ‰å¤´ã€é™é€Ÿã€åœè½¦æ ‡å¿—å’Œäº¤é€šä¿¡å·ç¯ã€‚è¿™äº›æ ‡å¿—åœ¨åŸå¸‚äº¤é€šä¸­å…·æœ‰é‡è¦çš„æŒ‡ç¤ºå’Œè­¦ç¤ºä½œç”¨ï¼Œå‡†ç¡®çš„æ£€æµ‹å’Œè¯†åˆ«èƒ½å¤Ÿæœ‰æ•ˆå‡å°‘äº¤é€šäº‹æ•…çš„å‘ç”Ÿã€‚é€šè¿‡å¯¹è¿™äº›æ ‡å¿—çš„è‡ªåŠ¨æ£€æµ‹ï¼Œä¸ä»…å¯ä»¥æé«˜äº¤é€šç®¡ç†çš„æ™ºèƒ½åŒ–æ°´å¹³ï¼Œè¿˜èƒ½ä¸ºè‡ªåŠ¨é©¾é©¶æŠ€æœ¯çš„å‘å±•æä¾›æ•°æ®æ”¯æŒã€‚

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œäº¤é€šæ ‡å¿—çš„ç§ç±»ç¹å¤šä¸”ç¯å¢ƒå¤æ‚ï¼Œå…‰ç…§å˜åŒ–ã€é®æŒ¡ã€æ±¡æŸç­‰å› ç´ éƒ½ä¼šå½±å“æ ‡å¿—çš„å¯è§æ€§å’Œè¯†åˆ«ç‡ã€‚å› æ­¤ï¼Œæ”¹è¿›YOLOv8æ¨¡å‹çš„ç ”ç©¶æ„ä¹‰åœ¨äºæå‡å…¶åœ¨å„ç§å¤æ‚åœºæ™¯ä¸‹çš„é²æ£’æ€§å’Œé€‚åº”æ€§ã€‚é€šè¿‡å¼•å…¥æ•°æ®å¢å¼ºã€æ¨¡å‹é›†æˆç­‰æŠ€æœ¯æ‰‹æ®µï¼Œæˆ‘ä»¬å¯ä»¥æœ‰æ•ˆæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œä½¿å…¶åœ¨ä¸åŒçš„ç¯å¢ƒæ¡ä»¶ä¸‹ä¾ç„¶èƒ½å¤Ÿä¿æŒé«˜æ•ˆçš„æ£€æµ‹æ€§èƒ½ã€‚

æ­¤å¤–ï¼Œéšç€äººå·¥æ™ºèƒ½æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œäº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†çš„è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿä¸ä»…å¯ä»¥åº”ç”¨äºä¼ ç»Ÿçš„äº¤é€šç®¡ç†ï¼Œè¿˜å¯ä»¥ä¸æ™ºèƒ½äº¤é€šä¿¡å·æ§åˆ¶ã€è½¦è”ç½‘ç­‰æŠ€æœ¯ç›¸ç»“åˆï¼Œå½¢æˆä¸€ä¸ªç»¼åˆçš„æ™ºèƒ½äº¤é€šè§£å†³æ–¹æ¡ˆã€‚è¿™å°†ä¸ºåŸå¸‚äº¤é€šçš„æ™ºèƒ½åŒ–ã€ä¿¡æ¯åŒ–å‘å±•æä¾›æ–°çš„æ€è·¯å’Œæ–¹å‘ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„äº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œä¸ä»…å…·æœ‰é‡è¦çš„ç†è®ºæ„ä¹‰ï¼Œä¹Ÿå…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚é€šè¿‡æé«˜äº¤é€šæ ‡å¿—çš„æ£€æµ‹æ•ˆç‡å’Œå‡†ç¡®æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæå‡äº¤é€šå®‰å…¨ã€ä¼˜åŒ–äº¤é€šç®¡ç†æä¾›æœ‰åŠ›çš„æŠ€æœ¯æ”¯æŒï¼Œæ¨åŠ¨æ™ºèƒ½äº¤é€šç³»ç»Ÿçš„è¿›ä¸€æ­¥å‘å±•ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1ucxLeUEJR/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 6
names: ['Bumps', 'Crosswalk', 'No-Uturn', 'Speedlimit', 'Stop', 'Trafficlight']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨ç°ä»£æ™ºèƒ½äº¤é€šç³»ç»Ÿçš„ç ”ç©¶ä¸åº”ç”¨ä¸­ï¼Œäº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†çš„å‡†ç¡®æ£€æµ‹æ˜¯ç¡®ä¿é“è·¯å®‰å…¨å’Œæé«˜äº¤é€šæ•ˆç‡çš„å…³é”®å› ç´ ä¹‹ä¸€ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªåä¸ºâ€œTrafficCombineâ€çš„æ•°æ®é›†ï¼Œæ—¨åœ¨ä¸ºæ”¹è¿›YOLOv8çš„äº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†æ£€æµ‹ç³»ç»Ÿæä¾›é«˜è´¨é‡çš„è®­ç»ƒæ•°æ®ã€‚è¯¥æ•°æ®é›†åŒ…å«å…­ä¸ªä¸»è¦ç±»åˆ«ï¼Œåˆ†åˆ«æ˜¯â€œBumpsâ€ï¼ˆå‡é€Ÿå¸¦ï¼‰ã€â€œCrosswalkâ€ï¼ˆäººè¡Œæ¨ªé“ï¼‰ã€â€œNo-Uturnâ€ï¼ˆç¦æ­¢æ‰å¤´ï¼‰ã€â€œSpeedlimitâ€ï¼ˆé™é€Ÿæ ‡å¿—ï¼‰ã€â€œStopâ€ï¼ˆåœè½¦æ ‡å¿—ï¼‰å’Œâ€œTrafficlightâ€ï¼ˆäº¤é€šä¿¡å·ç¯ï¼‰ã€‚è¿™äº›ç±»åˆ«çš„é€‰æ‹©ä¸ä»…æ¶µç›–äº†äº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†çš„å¤šæ ·æ€§ï¼Œè¿˜è€ƒè™‘åˆ°äº†ä¸åŒäº¤é€šåœºæ™¯ä¸‹çš„å®é™…åº”ç”¨éœ€æ±‚ã€‚

â€œTrafficCombineâ€æ•°æ®é›†çš„æ„å»ºè¿‡ç¨‹ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œç¡®ä¿äº†æ•°æ®çš„å¤šæ ·æ€§å’Œä»£è¡¨æ€§ã€‚æˆ‘ä»¬ä»å¤šä¸ªåŸå¸‚å’Œåœ°åŒºæ”¶é›†äº†å¤§é‡çš„äº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†å›¾åƒï¼Œæ¶µç›–äº†ä¸åŒçš„å¤©æ°”æ¡ä»¶ã€å…‰ç…§å˜åŒ–å’Œäº¤é€šç¯å¢ƒã€‚è¿™ç§å¤šæ ·æ€§ä½¿å¾—æ•°æ®é›†èƒ½å¤Ÿæ›´å¥½åœ°æ¨¡æ‹Ÿç°å®ä¸–ç•Œä¸­çš„å¤æ‚æƒ…å†µï¼Œä»è€Œæé«˜YOLOv8æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­çš„é²æ£’æ€§å’Œå‡†ç¡®æ€§ã€‚æ¯ä¸ªç±»åˆ«çš„å›¾åƒéƒ½ç»è¿‡ä¸¥æ ¼çš„æ ‡æ³¨ï¼Œç¡®ä¿æ¯ä¸ªæ ‡å¿—çš„è¾¹ç•Œæ¡†å’Œç±»åˆ«æ ‡ç­¾çš„å‡†ç¡®æ€§ï¼Œä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†å¯é çš„åŸºç¡€ã€‚

åœ¨æ•°æ®é›†çš„è§„æ¨¡æ–¹é¢ï¼Œâ€œTrafficCombineâ€ä¸ä»…åŒ…å«ä¸°å¯Œçš„å›¾åƒæ•°é‡ï¼Œè¿˜ç¡®ä¿äº†æ¯ä¸ªç±»åˆ«çš„æ ·æœ¬å‡è¡¡åˆ†å¸ƒã€‚è¿™ç§å‡è¡¡æ€§æœ‰åŠ©äºé¿å…æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯¹æŸäº›ç±»åˆ«çš„åå€šï¼Œæé«˜äº†æ¨¡å‹å¯¹æ‰€æœ‰ç±»åˆ«çš„è¯†åˆ«èƒ½åŠ›ã€‚ä¸ºäº†è¿›ä¸€æ­¥å¢å¼ºæ•°æ®é›†çš„å®ç”¨æ€§ï¼Œæˆ‘ä»¬è¿˜å¯¹å›¾åƒè¿›è¡Œäº†å¤šç§æ•°æ®å¢å¼ºå¤„ç†ï¼ŒåŒ…æ‹¬æ—‹è½¬ã€ç¼©æ”¾ã€è£å‰ªå’Œé¢œè‰²å˜æ¢ç­‰ã€‚è¿™äº›å¢å¼ºæ‰‹æ®µä¸ä»…å¢åŠ äº†æ•°æ®é›†çš„å¤šæ ·æ€§ï¼Œè¿˜æé«˜äº†æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨ä¸åŒçš„åœºæ™¯ä¸­ä¿æŒè‰¯å¥½çš„æ€§èƒ½ã€‚

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œäº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†çš„æ£€æµ‹ä¸ä»…éœ€è¦é«˜å‡†ç¡®ç‡ï¼Œè¿˜è¦æ±‚å¿«é€Ÿå“åº”ï¼Œä»¥é€‚åº”å®æ—¶äº¤é€šç®¡ç†çš„éœ€æ±‚ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è®¾è®¡â€œTrafficCombineâ€æ•°æ®é›†æ—¶ï¼Œç‰¹åˆ«å…³æ³¨äº†æ ‡å¿—çš„æ¸…æ™°åº¦å’Œå¯è¾¨è¯†æ€§ã€‚æ‰€æœ‰å›¾åƒå‡ç»è¿‡ç²¾å¿ƒæŒ‘é€‰ï¼Œç¡®ä¿æ ‡å¿—åœ¨å„ç§ç¯å¢ƒä¸‹éƒ½èƒ½è¢«æ¸…æ™°è¯†åˆ«ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿä¸ºYOLOv8æ¨¡å‹çš„è®­ç»ƒæä¾›ä¸€ä¸ªé«˜è´¨é‡çš„åŸºç¡€ï¼Œä½¿å…¶åœ¨å®é™…åº”ç”¨ä¸­èƒ½å¤Ÿå¿«é€Ÿã€å‡†ç¡®åœ°è¯†åˆ«äº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†ã€‚

æ€»ä¹‹ï¼Œâ€œTrafficCombineâ€æ•°æ®é›†çš„æ„å»ºä¸ä»…æ˜¯ä¸ºäº†æå‡YOLOv8æ¨¡å‹çš„æ€§èƒ½ï¼Œæ›´æ˜¯ä¸ºäº†æ¨åŠ¨æ™ºèƒ½äº¤é€šç³»ç»Ÿçš„å‘å±•ã€‚é€šè¿‡æä¾›ä¸€ä¸ªå…¨é¢ã€å‡è¡¡ä¸”é«˜è´¨é‡çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬æœŸæœ›èƒ½å¤Ÿä¸ºæœªæ¥çš„äº¤é€šç®¡ç†å’Œå®‰å…¨æä¾›æ›´ä¸ºå¼ºå¤§çš„æŠ€æœ¯æ”¯æŒã€‚éšç€äº¤é€šæ ‡å¿—ä¸è·¯é¢æ ‡è¯†æ£€æµ‹æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥ï¼Œæˆ‘ä»¬ç›¸ä¿¡è¿™ä¸€æ•°æ®é›†å°†ä¸ºç ”ç©¶äººå‘˜å’Œå·¥ç¨‹å¸ˆä»¬æä¾›å®è´µçš„èµ„æºï¼ŒåŠ©åŠ›ä»–ä»¬åœ¨æ™ºèƒ½äº¤é€šé¢†åŸŸçš„æ¢ç´¢ä¸åˆ›æ–°ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOv8æ˜¯2023å¹´1æœˆç”±Ultralyticså‘å¸ƒçš„ä¸€æ¬¾å…ˆè¿›çš„ç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œæ ‡å¿—ç€YOLOç³»åˆ—ç®—æ³•çš„åˆä¸€æ¬¡é‡è¦è¿›åŒ–ã€‚è¯¥ç®—æ³•çš„è®¾è®¡çµæ„Ÿæºè‡ªäºä¹‹å‰çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬YOLOXã€YOLOv6ã€YOLOv7ä»¥åŠPPYOLOEç­‰ï¼Œé€šè¿‡æ•´åˆè¿™äº›å‰æ²¿æŠ€æœ¯ï¼ŒYOLOv8åœ¨ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé€Ÿåº¦ä¸Šè¾¾åˆ°äº†æ–°çš„é«˜åº¦ï¼Œå±•ç°å‡ºå…¶åœ¨å®æ—¶æ£€æµ‹é¢†åŸŸçš„å·¨å¤§æ½œåŠ›ã€‚

YOLOv8çš„æ¶æ„ä¸»è¦ç”±è¾“å…¥å±‚ã€ä¸»å¹²ç½‘ç»œï¼ˆBackboneï¼‰ã€ç‰¹å¾èåˆå±‚ï¼ˆNeckï¼‰å’Œæ£€æµ‹å¤´ï¼ˆHeadï¼‰ç»„æˆã€‚å…¶è¾“å…¥å±‚è´Ÿè´£æ¥æ”¶å¤„ç†åçš„å›¾åƒæ•°æ®ï¼Œä¸»å¹²ç½‘ç»œåˆ™è´Ÿè´£ç‰¹å¾æå–ï¼Œç‰¹å¾èåˆå±‚ç”¨äºå¤šå°ºåº¦ç‰¹å¾çš„æ•´åˆï¼Œè€Œæ£€æµ‹å¤´åˆ™å°†èåˆåçš„ç‰¹å¾è½¬åŒ–ä¸ºæœ€ç»ˆçš„æ£€æµ‹ç»“æœã€‚ä¸ä»¥å¾€çš„YOLOç³»åˆ—ç›¸æ¯”ï¼ŒYOLOv8åœ¨å„ä¸ªæ¨¡å—çš„è®¾è®¡ä¸Šéƒ½è¿›è¡Œäº†åˆ›æ–°å’Œä¼˜åŒ–ï¼Œå°¤å…¶æ˜¯åœ¨Backboneå’ŒHeadéƒ¨åˆ†çš„ç»“æ„ä¸Šï¼Œä½“ç°äº†æ›´é«˜çš„çµæ´»æ€§å’Œé€‚åº”æ€§ã€‚

åœ¨Backboneéƒ¨åˆ†ï¼ŒYOLOv8å»¶ç»­äº†YOLOv5çš„CSPDarknetè®¾è®¡ç†å¿µï¼Œä½†å°†åŸæœ‰çš„C3æ¨¡å—æ›¿æ¢ä¸ºC2fæ¨¡å—ã€‚C2fæ¨¡å—çš„è®¾è®¡çµæ„Ÿæ¥æºäºYOLOv7çš„ELANç»“æ„ï¼Œé€šè¿‡å¼•å…¥æ›´å¤šçš„æ®‹å·®è¿æ¥ï¼Œä½¿å¾—ç½‘ç»œåœ¨ä¿æŒè½»é‡åŒ–çš„åŒæ—¶ï¼Œèƒ½å¤Ÿè·å¾—æ›´ä¸°å¯Œçš„æ¢¯åº¦ä¿¡æ¯ã€‚è¿™ç§è®¾è®¡ä¸ä»…æå‡äº†ç‰¹å¾æå–çš„èƒ½åŠ›ï¼Œè¿˜æœ‰æ•ˆç¼“è§£äº†æ·±å±‚ç½‘ç»œä¸­çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œä»è€Œæé«˜äº†æ¨¡å‹çš„æ”¶æ•›é€Ÿåº¦å’Œæ£€æµ‹ç²¾åº¦ã€‚

YOLOv8åœ¨ç‰¹å¾èåˆå±‚é‡‡ç”¨äº†PAN-FPNç»“æ„ï¼Œè¿™ä¸€ç»“æ„çš„è®¾è®¡æ—¨åœ¨å……åˆ†èåˆä¸åŒå±‚æ¬¡çš„ç‰¹å¾ä¿¡æ¯ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¿›è¡Œç›®æ ‡æ£€æµ‹ã€‚PAN-FPNç»“æ„é€šè¿‡è‡ªä¸‹è€Œä¸Šçš„æ–¹å¼å°†é«˜å±‚ç‰¹å¾ä¸ä¸­å±‚ã€æµ…å±‚ç‰¹å¾è¿›è¡Œèåˆï¼ŒåŒæ—¶åœ¨è‡ªä¸Šè€Œä¸‹çš„è¿‡ç¨‹ä¸­ï¼Œç¡®ä¿æ¯ä¸€å±‚çš„ç‰¹å¾å›¾éƒ½èƒ½ä¿ç•™é€‚å½“çš„åˆ†è¾¨ç‡å’Œè¯­ä¹‰ä¿¡æ¯ã€‚è¿™ç§ç‰¹å¾èåˆçš„ç­–ç•¥ä½¿å¾—YOLOv8åœ¨å¤„ç†å¤šå°ºåº¦ç›®æ ‡æ—¶ï¼Œèƒ½å¤Ÿæ›´ä¸ºç²¾å‡†åœ°è¯†åˆ«å’Œå®šä½ã€‚

åœ¨æ£€æµ‹å¤´éƒ¨åˆ†ï¼ŒYOLOv8é‡‡ç”¨äº†å½“å‰æµè¡Œçš„è§£è€¦åˆå¤´ç»“æ„ï¼Œå°†åˆ†ç±»å’Œå›å½’ä»»åŠ¡åˆ†å¼€å¤„ç†ã€‚é€šè¿‡å¼•å…¥Anchor-Freeçš„æ€æƒ³ï¼ŒYOLOv8æ‘’å¼ƒäº†ä¼ ç»Ÿçš„Anchor-Basedæ–¹æ³•ï¼Œå‡å°‘äº†å¯¹å…ˆéªŒæ¡†çš„ä¾èµ–ï¼Œä»è€Œæé«˜äº†æ¨¡å‹çš„çµæ´»æ€§å’Œé€‚åº”æ€§ã€‚æ­¤å¤–ï¼ŒYOLOv8åœ¨æŸå¤±å‡½æ•°çš„è®¾è®¡ä¸Šä¹Ÿè¿›è¡Œäº†åˆ›æ–°ï¼Œé‡‡ç”¨äº†BCELossä½œä¸ºåˆ†ç±»æŸå¤±ï¼Œå¹¶ç»“åˆDFLLosså’ŒCIoULossä½œä¸ºå›å½’æŸå¤±ã€‚è¿™ç§å¤šæŸå¤±å‡½æ•°çš„ç»„åˆï¼Œæœ‰åŠ©äºæå‡æ¨¡å‹åœ¨å¤æ‚åœºæ™¯ä¸‹çš„æ£€æµ‹æ€§èƒ½ã€‚

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒYOLOv8å¼•å…¥äº†åŠ¨æ€çš„Task-Aligned Assigneræ ·æœ¬åˆ†é…ç­–ç•¥ï¼Œå¹¶åœ¨æ•°æ®å¢å¼ºæ–¹é¢é‡‡ç”¨äº†å¤šç§æŠ€æœ¯ï¼ŒåŒ…æ‹¬é©¬èµ›å…‹å¢å¼ºã€æ··åˆå¢å¼ºã€ç©ºé—´æ‰°åŠ¨å’Œé¢œè‰²æ‰°åŠ¨ç­‰ã€‚è¿™äº›æ•°æ®å¢å¼ºæ‰‹æ®µä¸ä»…æé«˜äº†æ¨¡å‹çš„é²æ£’æ€§ï¼Œè¿˜æœ‰æ•ˆåœ°æ‰©å±•äº†è®­ç»ƒæ ·æœ¬çš„å¤šæ ·æ€§ï¼Œä½¿å¾—æ¨¡å‹åœ¨é¢å¯¹ä¸åŒåœºæ™¯æ—¶ï¼Œèƒ½å¤Ÿä¿æŒè¾ƒé«˜çš„æ£€æµ‹ç²¾åº¦ã€‚

å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒYOLOv8åœ¨å¤„ç†å°ç›®æ ‡æ—¶è¡¨ç°å°¤ä¸ºçªå‡ºï¼Œè¿™å¾—ç›Šäºå…¶é‡‡ç”¨çš„Focal LossæŸå¤±å‡½æ•°ã€‚Focal Lossé€šè¿‡è°ƒæ•´æ ·æœ¬çš„æƒé‡ï¼Œç‰¹åˆ«æ˜¯å¯¹éš¾ä»¥åˆ†ç±»çš„å°ç›®æ ‡æ ·æœ¬ï¼Œå¢å¼ºäº†æ¨¡å‹å¯¹è¿™äº›æ ·æœ¬çš„å­¦ä¹ èƒ½åŠ›ã€‚è¿™ä¸€è®¾è®¡æœ‰æ•ˆè§£å†³äº†è®­ç»ƒè¿‡ç¨‹ä¸­æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡çš„é—®é¢˜ï¼Œä½¿å¾—YOLOv8åœ¨å®é™…åº”ç”¨ä¸­èƒ½å¤Ÿæ›´å¥½åœ°åº”å¯¹å„ç§å¤æ‚çš„æ£€æµ‹ä»»åŠ¡ã€‚

æ€»çš„æ¥è¯´ï¼ŒYOLOv8é€šè¿‡å¯¹ä¸»å¹²ç½‘ç»œã€ç‰¹å¾èåˆå±‚å’Œæ£€æµ‹å¤´çš„åˆ›æ–°è®¾è®¡ï¼Œç»“åˆå…ˆè¿›çš„æŸå¤±å‡½æ•°å’Œæ•°æ®å¢å¼ºç­–ç•¥ï¼Œå½¢æˆäº†ä¸€ç§é«˜æ•ˆã€ç²¾å‡†çš„ç›®æ ‡æ£€æµ‹è§£å†³æ–¹æ¡ˆã€‚å…¶åœ¨è‹¹æœé‡‡æ‘˜ç­‰å†œä¸šè‡ªåŠ¨åŒ–é¢†åŸŸçš„åº”ç”¨ï¼Œå±•ç¤ºäº†YOLOv8åœ¨å®é™…åœºæ™¯ä¸­çš„å¼ºå¤§èƒ½åŠ›ï¼Œæ ‡å¿—ç€ç›®æ ‡æ£€æµ‹æŠ€æœ¯åœ¨æ™ºèƒ½å†œä¸šä¸­çš„å¹¿æ³›åº”ç”¨å‰æ™¯ã€‚éšç€YOLOv8çš„ä¸æ–­å‘å±•å’Œä¼˜åŒ–ï¼Œæœªæ¥çš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡å°†æ›´åŠ é«˜æ•ˆå’Œæ™ºèƒ½åŒ–ï¼Œä¸ºå„è¡Œå„ä¸šå¸¦æ¥æ›´å¤§çš„ä¾¿åˆ©å’Œæ•ˆç›Šã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 code\ultralytics\utils\callbacks\base.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç²¾ç®€å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¸»è¦ä¿ç•™äº†å›è°ƒå‡½æ•°å’Œé»˜è®¤å›è°ƒå­—å…¸çš„å®šä¹‰ã€‚

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license
"""åŸºç¡€å›è°ƒå‡½æ•°å®šä¹‰ã€‚"""

from collections import defaultdict
from copy import deepcopy

# è®­ç»ƒå›è°ƒå‡½æ•° ----------------------------------------------------------------------------------------------------

def on_train_start(trainer):
    """è®­ç»ƒå¼€å§‹æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

def on_train_epoch_start(trainer):
    """æ¯ä¸ªè®­ç»ƒå‘¨æœŸå¼€å§‹æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

def on_train_batch_start(trainer):
    """æ¯ä¸ªè®­ç»ƒæ‰¹æ¬¡å¼€å§‹æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

def on_train_batch_end(trainer):
    """æ¯ä¸ªè®­ç»ƒæ‰¹æ¬¡ç»“æŸæ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

def on_train_epoch_end(trainer):
    """æ¯ä¸ªè®­ç»ƒå‘¨æœŸç»“æŸæ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

def on_train_end(trainer):
    """è®­ç»ƒç»“æŸæ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

# éªŒè¯å™¨å›è°ƒå‡½æ•° --------------------------------------------------------------------------------------------------

def on_val_start(validator):
    """éªŒè¯å¼€å§‹æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

def on_val_batch_end(validator):
    """æ¯ä¸ªéªŒè¯æ‰¹æ¬¡ç»“æŸæ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

def on_val_end(validator):
    """éªŒè¯ç»“æŸæ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

# é¢„æµ‹å™¨å›è°ƒå‡½æ•° --------------------------------------------------------------------------------------------------

def on_predict_start(predictor):
    """é¢„æµ‹å¼€å§‹æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

def on_predict_batch_end(predictor):
    """æ¯ä¸ªé¢„æµ‹æ‰¹æ¬¡ç»“æŸæ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

def on_predict_end(predictor):
    """é¢„æµ‹ç»“æŸæ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

# å¯¼å‡ºå™¨å›è°ƒå‡½æ•° ---------------------------------------------------------------------------------------------------

def on_export_start(exporter):
    """æ¨¡å‹å¯¼å‡ºå¼€å§‹æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

def on_export_end(exporter):
    """æ¨¡å‹å¯¼å‡ºç»“æŸæ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚"""
    pass

# é»˜è®¤å›è°ƒå­—å…¸ï¼ŒåŒ…å«æ‰€æœ‰çš„å›è°ƒå‡½æ•°ã€‚ç”¨äºåœ¨è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºè¿‡ç¨‹ä¸­è°ƒç”¨ç›¸åº”çš„å›è°ƒã€‚
default_callbacks = {
    "on_train_start": [on_train_start],
    "on_train_epoch_start": [on_train_epoch_start],
    "on_train_batch_start": [on_train_batch_start],
    "on_train_batch_end": [on_train_batch_end],
    "on_train_epoch_end": [on_train_epoch_end],
    "on_train_end": [on_train_end],
    "on_val_start": [on_val_start],
    "on_val_batch_end": [on_val_batch_end],
    "on_val_end": [on_val_end],
    "on_predict_start": [on_predict_start],
    "on_predict_batch_end": [on_predict_batch_end],
    "on_predict_end": [on_predict_end],
    "on_export_start": [on_export_start],
    "on_export_end": [on_export_end],
}

def get_default_callbacks():
    """
    è¿”å›ä¸€ä¸ªé»˜è®¤å›è°ƒå­—å…¸çš„å‰¯æœ¬ï¼Œå­—å…¸çš„å€¼ä¸ºé»˜è®¤ç©ºåˆ—è¡¨ã€‚

    è¿”å›:
        (defaultdict): ä¸€ä¸ªå¸¦æœ‰é»˜è®¤ç©ºåˆ—è¡¨çš„defaultdictï¼Œé”®æ¥è‡ªdefault_callbacksã€‚
    """
    return defaultdict(list, deepcopy(default_callbacks))
```

### ä»£ç è¯´æ˜ï¼š
1. **å›è°ƒå‡½æ•°**ï¼šå®šä¹‰äº†ä¸€ç³»åˆ—çš„å›è°ƒå‡½æ•°ï¼Œè¿™äº›å‡½æ•°åœ¨è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºè¿‡ç¨‹ä¸­è¢«è°ƒç”¨ã€‚æ¯ä¸ªå‡½æ•°ç›®å‰éƒ½åªæ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œå®é™…çš„é€»è¾‘éœ€è¦åœ¨å…·ä½“å®ç°ä¸­å¡«å……ã€‚
  
2. **é»˜è®¤å›è°ƒå­—å…¸**ï¼š`default_callbacks`å­—å…¸ç”¨äºå­˜å‚¨ä¸åŒé˜¶æ®µçš„å›è°ƒå‡½æ•°ï¼Œä¾¿äºåœ¨ç›¸åº”çš„è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºè¿‡ç¨‹ä¸­è°ƒç”¨ã€‚

3. **è·å–é»˜è®¤å›è°ƒå‡½æ•°**ï¼š`get_default_callbacks`å‡½æ•°è¿”å›ä¸€ä¸ªé»˜è®¤å›è°ƒå­—å…¸çš„å‰¯æœ¬ï¼Œç¡®ä¿åœ¨ä½¿ç”¨æ—¶ä¸ä¼šä¿®æ”¹åŸå§‹å­—å…¸ã€‚

è¿™äº›æ ¸å¿ƒéƒ¨åˆ†æ„æˆäº†å›è°ƒæœºåˆ¶çš„åŸºç¡€ï¼Œå…è®¸åœ¨è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹ä¸­çµæ´»åœ°æ’å…¥è‡ªå®šä¹‰é€»è¾‘ã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºUltralytics YOLOæ¡†æ¶çš„å›è°ƒå‡½æ•°æ¨¡å—ï¼Œä¸»è¦å®šä¹‰äº†ä¸€ç³»åˆ—åœ¨è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºè¿‡ç¨‹ä¸­å¯ä»¥è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚å›è°ƒå‡½æ•°æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå…è®¸åœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶æ‰§è¡Œè‡ªå®šä¹‰ä»£ç ã€‚æ–‡ä»¶ä¸­åŒ…å«çš„å›è°ƒå‡½æ•°ä¸»è¦ç”¨äºåœ¨ä¸åŒé˜¶æ®µæ‰§è¡Œç‰¹å®šæ“ä½œï¼Œæ¯”å¦‚åœ¨è®­ç»ƒå¼€å§‹ã€ç»“æŸæ—¶ï¼Œæˆ–è€…åœ¨æ¯ä¸ªæ‰¹æ¬¡çš„å¼€å§‹å’Œç»“æŸæ—¶ã€‚

æ–‡ä»¶å¼€å¤´å¼•å…¥äº†`defaultdict`å’Œ`deepcopy`ï¼Œè¿™ä¸¤ä¸ªæ¨¡å—åˆ†åˆ«ç”¨äºåˆ›å»ºä¸€ä¸ªå¸¦æœ‰é»˜è®¤å€¼çš„å­—å…¸å’Œæ·±æ‹·è´å¯¹è±¡ã€‚æ¥ä¸‹æ¥ï¼Œæ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ç³»åˆ—çš„å›è°ƒå‡½æ•°ï¼Œè¿™äº›å‡½æ•°çš„ä¸»ä½“ç›®å‰éƒ½æ˜¯ç©ºçš„ï¼Œè¡¨ç¤ºåœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶å¯ä»¥æ’å…¥è‡ªå®šä¹‰é€»è¾‘ã€‚

åœ¨è®­ç»ƒé˜¶æ®µï¼Œå®šä¹‰çš„å›è°ƒå‡½æ•°åŒ…æ‹¬ï¼š
- `on_pretrain_routine_start`å’Œ`on_pretrain_routine_end`ï¼šåœ¨é¢„è®­ç»ƒå¼€å§‹å’Œç»“æŸæ—¶è°ƒç”¨ã€‚
- `on_train_start`ï¼šè®­ç»ƒå¼€å§‹æ—¶è°ƒç”¨ã€‚
- `on_train_epoch_start`å’Œ`on_train_epoch_end`ï¼šæ¯ä¸ªè®­ç»ƒå‘¨æœŸå¼€å§‹å’Œç»“æŸæ—¶è°ƒç”¨ã€‚
- `on_train_batch_start`å’Œ`on_train_batch_end`ï¼šæ¯ä¸ªè®­ç»ƒæ‰¹æ¬¡å¼€å§‹å’Œç»“æŸæ—¶è°ƒç”¨ã€‚
- `optimizer_step`ï¼šä¼˜åŒ–å™¨æ›´æ–°å‚æ•°æ—¶è°ƒç”¨ã€‚
- `on_before_zero_grad`ï¼šåœ¨æ¢¯åº¦å½’é›¶ä¹‹å‰è°ƒç”¨ã€‚
- `on_fit_epoch_end`ï¼šåœ¨æ¯ä¸ªè®­ç»ƒå’ŒéªŒè¯å‘¨æœŸç»“æŸæ—¶è°ƒç”¨ã€‚
- `on_model_save`ï¼šæ¨¡å‹ä¿å­˜æ—¶è°ƒç”¨ã€‚
- `on_train_end`ï¼šè®­ç»ƒç»“æŸæ—¶è°ƒç”¨ã€‚
- `on_params_update`ï¼šæ¨¡å‹å‚æ•°æ›´æ–°æ—¶è°ƒç”¨ã€‚
- `teardown`ï¼šè®­ç»ƒè¿‡ç¨‹ç»“æŸæ—¶çš„æ¸…ç†å·¥ä½œã€‚

åœ¨éªŒè¯é˜¶æ®µï¼Œå®šä¹‰çš„å›è°ƒå‡½æ•°åŒ…æ‹¬ï¼š
- `on_val_start`ã€`on_val_batch_start`ã€`on_val_batch_end`å’Œ`on_val_end`ï¼šåˆ†åˆ«åœ¨éªŒè¯å¼€å§‹ã€æ¯ä¸ªéªŒè¯æ‰¹æ¬¡å¼€å§‹ã€ç»“æŸæ—¶è°ƒç”¨ï¼Œä»¥åŠéªŒè¯ç»“æŸæ—¶è°ƒç”¨ã€‚

åœ¨é¢„æµ‹é˜¶æ®µï¼Œå®šä¹‰çš„å›è°ƒå‡½æ•°åŒ…æ‹¬ï¼š
- `on_predict_start`ã€`on_predict_batch_start`ã€`on_predict_batch_end`ã€`on_predict_postprocess_end`å’Œ`on_predict_end`ï¼šåˆ†åˆ«åœ¨é¢„æµ‹å¼€å§‹ã€æ¯ä¸ªé¢„æµ‹æ‰¹æ¬¡å¼€å§‹ã€ç»“æŸæ—¶è°ƒç”¨ï¼Œä»¥åŠé¢„æµ‹åå¤„ç†ç»“æŸå’Œé¢„æµ‹ç»“æŸæ—¶è°ƒç”¨ã€‚

åœ¨å¯¼å‡ºé˜¶æ®µï¼Œå®šä¹‰çš„å›è°ƒå‡½æ•°åŒ…æ‹¬ï¼š
- `on_export_start`å’Œ`on_export_end`ï¼šåœ¨æ¨¡å‹å¯¼å‡ºå¼€å§‹å’Œç»“æŸæ—¶è°ƒç”¨ã€‚

æ¥ä¸‹æ¥ï¼Œæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ª`default_callbacks`å­—å…¸ï¼Œå°†æ‰€æœ‰çš„å›è°ƒå‡½æ•°æŒ‰ç±»åˆ«ç»„ç»‡èµ·æ¥ï¼Œä»¥ä¾¿äºç®¡ç†å’Œè°ƒç”¨ã€‚è¿™ä¸ªå­—å…¸çš„é”®æ˜¯å›è°ƒå‡½æ•°çš„åç§°ï¼Œå€¼æ˜¯åŒ…å«ç›¸åº”å›è°ƒå‡½æ•°çš„åˆ—è¡¨ã€‚

`get_default_callbacks`å‡½æ•°è¿”å›ä¸€ä¸ªæ·±æ‹·è´çš„`default_callbacks`å­—å…¸ï¼Œç¡®ä¿æ¯æ¬¡è°ƒç”¨æ—¶éƒ½èƒ½å¾—åˆ°ä¸€ä¸ªæ–°çš„å­—å…¸å®ä¾‹ã€‚

`add_integration_callbacks`å‡½æ•°ç”¨äºå°†æ¥è‡ªä¸åŒæ¥æºçš„é›†æˆå›è°ƒæ·»åŠ åˆ°å®ä¾‹çš„å›è°ƒå­—å…¸ä¸­ã€‚å®ƒé¦–å…ˆåŠ è½½HUBå›è°ƒï¼Œç„¶åæ ¹æ®å®ä¾‹çš„ç±»å‹ï¼ˆå¦‚Trainerã€Predictorç­‰ï¼‰åŠ è½½ç›¸åº”çš„å›è°ƒï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°å®ä¾‹çš„å›è°ƒå­—å…¸ä¸­ã€‚è¿™ç§è®¾è®¡ä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°æ‰©å±•å’Œé›†æˆå…¶ä»–å›è°ƒåŠŸèƒ½ï¼Œä»¥æ»¡è¶³ç‰¹å®šéœ€æ±‚ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸ºUltralytics YOLOæ¡†æ¶æä¾›äº†ä¸€ä¸ªçµæ´»çš„å›è°ƒæœºåˆ¶ï¼Œå…è®¸ç”¨æˆ·åœ¨è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºè¿‡ç¨‹ä¸­æ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼Œä»¥ä¾¿äºç›‘æ§å’Œæ§åˆ¶æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚

#### 11.2 ui.py

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤ï¼Œä½¿ç”¨ streamlit è¿è¡ŒæŒ‡å®šçš„è„šæœ¬
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤å¹¶ç­‰å¾…å…¶å®Œæˆ
    result = subprocess.run(command, shell=True)
    
    # æ£€æŸ¥å‘½ä»¤æ‰§è¡Œçš„è¿”å›ç ï¼Œå¦‚æœä¸ä¸º0åˆ™è¡¨ç¤ºå‡ºé”™
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")


# ä¸»ç¨‹åºå…¥å£
if __name__ == "__main__":
    # æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # å‡è®¾è„šæœ¬åœ¨å½“å‰ç›®å½•ä¸‹

    # è°ƒç”¨å‡½æ•°è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `sys`ï¼šç”¨äºè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - `subprocess`ï¼šç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **å®šä¹‰ `run_script` å‡½æ•°**ï¼š
   - æ¥æ”¶ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„ Python è„šæœ¬çš„è·¯å¾„ã€‚
   - ä½¿ç”¨ `sys.executable` è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - æ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œç”¨äºé€šè¿‡ `streamlit` è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚
   - ä½¿ç”¨ `subprocess.run` æ‰§è¡Œæ„å»ºçš„å‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆã€‚
   - æ£€æŸ¥å‘½ä»¤çš„è¿”å›ç ï¼Œå¦‚æœè¿”å›ç ä¸ä¸º0ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œå‡ºé”™ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯ã€‚

3. **ä¸»ç¨‹åºå…¥å£**ï¼š
   - åœ¨ `if __name__ == "__main__":` å—ä¸­ï¼ŒæŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼ˆè¿™é‡Œå‡è®¾ä¸º `web.py`ï¼‰ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°ï¼Œä¼ å…¥è„šæœ¬è·¯å¾„ä»¥æ‰§è¡Œè¯¥è„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ˜¯ä½¿ç”¨ Streamlit æ¡†æ¶æ¥å¯åŠ¨ä¸€ä¸ª Web åº”ç”¨ã€‚é¦–å…ˆï¼Œç¨‹åºå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œå…¶ä¸­ `sys` ç”¨äºè·å–å½“å‰ Python è§£é‡Šå™¨çš„ä¿¡æ¯ï¼Œ`subprocess` ç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œé¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ Python ç¯å¢ƒæ¥è¿è¡Œè„šæœ¬ã€‚æ¥ç€ï¼Œæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šè°ƒç”¨ Streamlit æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚å‘½ä»¤çš„æ ¼å¼æ˜¯ `python -m streamlit run "script_path"`ï¼Œå…¶ä¸­ `script_path` æ˜¯è¦è¿è¡Œçš„è„šæœ¬çš„è·¯å¾„ã€‚

ç„¶åï¼Œä½¿ç”¨ `subprocess.run` æ–¹æ³•æ¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œ`shell=True` å‚æ•°å…è®¸åœ¨ shell ä¸­æ‰§è¡Œå‘½ä»¤ã€‚æ‰§è¡Œåï¼Œç¨‹åºä¼šæ£€æŸ¥è¿”å›çš„çŠ¶æ€ç ï¼Œå¦‚æœè¿”å›ç ä¸ä¸ºé›¶ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œå‡ºé”™ï¼Œç¨‹åºä¼šè¾“å‡ºä¸€æ¡é”™è¯¯ä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œä½¿ç”¨ `if __name__ == "__main__":` æ¥ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥æ–‡ä»¶æ—¶æ‰ä¼šæ‰§è¡Œåé¢çš„ä»£ç ã€‚è¿™é‡ŒæŒ‡å®šäº†è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ä¸º `web.py`ï¼Œå¹¶è°ƒç”¨ `run_script` å‡½æ•°æ¥å¯åŠ¨è¿™ä¸ªè„šæœ¬ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºæ˜¯ä¸€ä¸ªç®€å•çš„è„šæœ¬å¯åŠ¨å™¨ï¼Œæ—¨åœ¨æ–¹ä¾¿åœ°é€šè¿‡å½“å‰ Python ç¯å¢ƒè¿è¡Œä¸€ä¸ª Streamlit åº”ç”¨ã€‚

#### 11.3 code\ultralytics\data\augment.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¸»è¦åŒ…æ‹¬å›¾åƒå¢å¼ºçš„åŸºç¡€ç±»å’Œä¸€äº›å…·ä½“çš„å¢å¼ºå®ç°ï¼š

```python
import random
import numpy as np
import cv2

class BaseTransform:
    """
    å›¾åƒå˜æ¢çš„åŸºç¡€ç±»ï¼Œæä¾›äº†ä¸€äº›é€šç”¨çš„å›¾åƒå¤„ç†æ–¹æ³•ã€‚
    """

    def __init__(self) -> None:
        """åˆå§‹åŒ–åŸºç¡€å˜æ¢å¯¹è±¡ã€‚"""
        pass

    def apply_image(self, labels):
        """åº”ç”¨å›¾åƒå˜æ¢åˆ°æ ‡ç­¾ã€‚"""
        pass

    def apply_instances(self, labels):
        """åº”ç”¨å˜æ¢åˆ°æ ‡ç­¾ä¸­çš„ç‰©ä½“å®ä¾‹ã€‚"""
        pass

    def apply_semantic(self, labels):
        """åº”ç”¨è¯­ä¹‰åˆ†å‰²åˆ°å›¾åƒã€‚"""
        pass

    def __call__(self, labels):
        """åº”ç”¨æ‰€æœ‰æ ‡ç­¾å˜æ¢åˆ°å›¾åƒã€å®ä¾‹å’Œè¯­ä¹‰æ©ç ã€‚"""
        self.apply_image(labels)
        self.apply_instances(labels)
        self.apply_semantic(labels)


class Compose:
    """
    ç»„åˆå¤šä¸ªå›¾åƒå˜æ¢çš„ç±»ã€‚
    """

    def __init__(self, transforms):
        """åˆå§‹åŒ–ç»„åˆå¯¹è±¡ï¼Œæ¥å—ä¸€ä¸ªå˜æ¢åˆ—è¡¨ã€‚"""
        self.transforms = transforms

    def __call__(self, data):
        """ä¾æ¬¡åº”ç”¨å˜æ¢åˆ°è¾“å…¥æ•°æ®ã€‚"""
        for t in self.transforms:
            data = t(data)
        return data


class Mosaic(BaseTransform):
    """
    é©¬èµ›å…‹å¢å¼ºï¼Œé€šè¿‡å°†å¤šä¸ªå›¾åƒç»„åˆæˆä¸€ä¸ªé©¬èµ›å…‹å›¾åƒæ¥è¿›è¡Œå¢å¼ºã€‚
    """

    def __init__(self, dataset, imgsz=640, p=1.0, n=4):
        """åˆå§‹åŒ–é©¬èµ›å…‹å¯¹è±¡ï¼Œè®¾ç½®æ•°æ®é›†ã€å›¾åƒå¤§å°ã€æ¦‚ç‡å’Œç½‘æ ¼å¤§å°ã€‚"""
        assert 0 <= p <= 1.0, f"æ¦‚ç‡åº”åœ¨[0, 1]èŒƒå›´å†…ï¼Œä½†å¾—åˆ°{p}ã€‚"
        assert n in (4, 9), "ç½‘æ ¼å¤§å°å¿…é¡»ä¸º4æˆ–9ã€‚"
        self.dataset = dataset
        self.imgsz = imgsz
        self.p = p
        self.n = n

    def get_indexes(self):
        """ä»æ•°æ®é›†ä¸­éšæœºé€‰æ‹©ç´¢å¼•ã€‚"""
        return random.sample(range(len(self.dataset)), self.n - 1)

    def _mix_transform(self, labels):
        """åº”ç”¨é©¬èµ›å…‹å¢å¼ºåˆ°æ ‡ç­¾å­—å…¸ã€‚"""
        mix_labels = [self.dataset[i] for i in self.get_indexes()]
        # è¿›è¡Œé©¬èµ›å…‹åˆæˆ
        return self._mosaic4(labels, mix_labels)  # å‡è®¾ä½¿ç”¨4å›¾åƒçš„é©¬èµ›å…‹

    def _mosaic4(self, labels, mix_labels):
        """åˆ›å»ºä¸€ä¸ª2x2çš„é©¬èµ›å…‹å›¾åƒã€‚"""
        mosaic_img = np.full((self.imgsz * 2, self.imgsz * 2, 3), 114, dtype=np.uint8)  # åˆ›å»ºåŸºç¡€å›¾åƒ
        # å°†4ä¸ªå›¾åƒæ”¾ç½®åˆ°é©¬èµ›å…‹å›¾åƒä¸­
        for i, mix_label in enumerate(mix_labels):
            img = mix_label["img"]
            h, w = img.shape[:2]
            # è®¡ç®—æ”¾ç½®ä½ç½®
            if i == 0:  # å·¦ä¸Š
                mosaic_img[0:h, 0:w] = img
            elif i == 1:  # å³ä¸Š
                mosaic_img[0:h, self.imgsz:self.imgsz + w] = img
            elif i == 2:  # å·¦ä¸‹
                mosaic_img[self.imgsz:self.imgsz + h, 0:w] = img
            elif i == 3:  # å³ä¸‹
                mosaic_img[self.imgsz:self.imgsz + h, self.imgsz:self.imgsz + w] = img
        labels["img"] = mosaic_img  # æ›´æ–°æ ‡ç­¾ä¸­çš„å›¾åƒ
        return labels


class RandomFlip:
    """
    éšæœºç¿»è½¬å›¾åƒçš„ç±»ï¼Œå¯ä»¥è¿›è¡Œæ°´å¹³æˆ–å‚ç›´ç¿»è½¬ã€‚
    """

    def __init__(self, p=0.5, direction="horizontal"):
        """åˆå§‹åŒ–éšæœºç¿»è½¬å¯¹è±¡ï¼Œè®¾ç½®ç¿»è½¬æ¦‚ç‡å’Œæ–¹å‘ã€‚"""
        assert direction in ["horizontal", "vertical"], "æ”¯æŒçš„æ–¹å‘ä¸º'horizontal'æˆ–'vertical'ã€‚"
        self.p = p
        self.direction = direction

    def __call__(self, labels):
        """åº”ç”¨éšæœºç¿»è½¬åˆ°å›¾åƒå’Œå®ä¾‹ã€‚"""
        img = labels["img"]
        if random.random() < self.p:  # æ ¹æ®æ¦‚ç‡å†³å®šæ˜¯å¦ç¿»è½¬
            if self.direction == "horizontal":
                img = np.fliplr(img)  # æ°´å¹³ç¿»è½¬
            elif self.direction == "vertical":
                img = np.flipud(img)  # å‚ç›´ç¿»è½¬
        labels["img"] = img  # æ›´æ–°æ ‡ç­¾ä¸­çš„å›¾åƒ
        return labels


# ç¤ºä¾‹ä½¿ç”¨
# dataset = ...  # å‡è®¾æœ‰ä¸€ä¸ªæ•°æ®é›†
# transforms = Compose([Mosaic(dataset), RandomFlip(p=0.5)])
# labels = {"img": image_data}  # å‡è®¾æœ‰å›¾åƒæ•°æ®
# transformed_labels = transforms(labels)  # åº”ç”¨å˜æ¢
```

### ä»£ç è¯´æ˜ï¼š
1. **BaseTransform**: å®šä¹‰äº†å›¾åƒå˜æ¢çš„åŸºç¡€ç±»ï¼ŒåŒ…å«äº†åº”ç”¨å›¾åƒã€å®ä¾‹å’Œè¯­ä¹‰çš„åŸºæœ¬æ–¹æ³•ã€‚
2. **Compose**: ç»„åˆå¤šä¸ªå˜æ¢çš„æ–¹æ³•ï¼Œä¾æ¬¡åº”ç”¨å˜æ¢åˆ°è¾“å…¥æ•°æ®ã€‚
3. **Mosaic**: å®ç°é©¬èµ›å…‹å¢å¼ºï¼Œé€šè¿‡å°†å¤šä¸ªå›¾åƒç»„åˆæˆä¸€ä¸ªå›¾åƒæ¥å¢å¼ºæ•°æ®é›†ã€‚
4. **RandomFlip**: éšæœºç¿»è½¬å›¾åƒçš„å®ç°ï¼Œå¯ä»¥é€‰æ‹©æ°´å¹³æˆ–å‚ç›´ç¿»è½¬ã€‚

è¿™äº›ç±»å’Œæ–¹æ³•æ„æˆäº†å›¾åƒå¢å¼ºçš„åŸºç¡€ï¼Œèƒ½å¤Ÿç”¨äºè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œæå‡æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `augment.py` æ˜¯ Ultralytics YOLO æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºå›¾åƒå¢å¼ºå’Œé¢„å¤„ç†ã€‚æ–‡ä»¶ä¸­å®šä¹‰äº†å¤šä¸ªç±»å’Œæ–¹æ³•ï¼Œæ—¨åœ¨å¯¹è¾“å…¥å›¾åƒåŠå…¶æ ‡ç­¾è¿›è¡Œå„ç§å˜æ¢ï¼Œä»¥æé«˜æ¨¡å‹çš„é²æ£’æ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬æ•°å­¦è¿ç®—ã€éšæœºæ•°ç”Ÿæˆã€å›¾åƒå¤„ç†ï¼ˆOpenCVï¼‰ã€NumPyã€PyTorch åŠå…¶ç›¸å…³æ¨¡å—ã€‚ç„¶åå®šä¹‰äº†ä¸€äº›å¸¸é‡ï¼Œä¾‹å¦‚é»˜è®¤çš„å‡å€¼å’Œæ ‡å‡†å·®ï¼Œç”¨äºå›¾åƒå½’ä¸€åŒ–ã€‚

æ¥ä¸‹æ¥ï¼Œå®šä¹‰äº†ä¸€ä¸ª `BaseTransform` ç±»ï¼Œä½œä¸ºæ‰€æœ‰å›¾åƒå˜æ¢çš„åŸºç±»ã€‚è¿™ä¸ªç±»åŒ…å«äº†åº”ç”¨å›¾åƒå˜æ¢çš„æ–¹æ³•ï¼Œä½†å…·ä½“çš„å®ç°ç•™ç»™å­ç±»ã€‚`Compose` ç±»åˆ™ç”¨äºå°†å¤šä¸ªå˜æ¢ç»„åˆåœ¨ä¸€èµ·ï¼Œå…è®¸ç”¨æˆ·æŒ‰é¡ºåºåº”ç”¨å¤šä¸ªå˜æ¢ã€‚

`BaseMixTransform` ç±»æ˜¯ç”¨äºæ··åˆå¢å¼ºï¼ˆå¦‚ MixUp å’Œ Mosaicï¼‰çš„åŸºç±»ã€‚å®ƒæä¾›äº†åŸºæœ¬çš„æ¡†æ¶å’Œæ–¹æ³•æ¥å®ç°è¿™äº›å¢å¼ºç­–ç•¥ã€‚`Mosaic` ç±»å®ç°äº†é©¬èµ›å…‹å¢å¼ºï¼Œé€šè¿‡å°†å¤šä¸ªå›¾åƒç»„åˆæˆä¸€ä¸ªå•ä¸€çš„å›¾åƒæ¥å¢åŠ æ•°æ®çš„å¤šæ ·æ€§ã€‚`MixUp` ç±»åˆ™å®ç°äº† MixUp å¢å¼ºï¼Œé€šè¿‡å°†ä¸¤å¼ å›¾åƒæŒ‰æ¯”ä¾‹æ··åˆæ¥ç”Ÿæˆæ–°çš„å›¾åƒã€‚

`RandomPerspective` ç±»å®ç°äº†éšæœºé€è§†å˜æ¢ï¼Œå¯ä»¥å¯¹å›¾åƒè¿›è¡Œæ—‹è½¬ã€å¹³ç§»ã€ç¼©æ”¾å’Œå‰ªåˆ‡ç­‰æ“ä½œï¼ŒåŒæ—¶æ›´æ–°å¯¹åº”çš„è¾¹ç•Œæ¡†ã€åˆ†å‰²å’Œå…³é”®ç‚¹ä¿¡æ¯ã€‚`RandomHSV` ç±»åˆ™å¯¹å›¾åƒçš„è‰²è°ƒã€é¥±å’Œåº¦å’Œäº®åº¦è¿›è¡Œéšæœºè°ƒæ•´ï¼Œä»¥å¢å¼ºè‰²å½©çš„å¤šæ ·æ€§ã€‚

`RandomFlip` ç±»ç”¨äºéšæœºç¿»è½¬å›¾åƒï¼Œæ”¯æŒæ°´å¹³å’Œå‚ç›´ç¿»è½¬ï¼Œå¹¶ç›¸åº”åœ°æ›´æ–°è¾¹ç•Œæ¡†å’Œå…³é”®ç‚¹ã€‚`LetterBox` ç±»åˆ™ç”¨äºè°ƒæ•´å›¾åƒå¤§å°å¹¶å¡«å……è¾¹æ¡†ï¼Œä»¥é€‚åº”ç›®æ ‡æ£€æµ‹å’Œå®ä¾‹åˆ†å‰²çš„è¦æ±‚ã€‚

`CopyPaste` ç±»å®ç°äº†å¤åˆ¶ç²˜è´´å¢å¼ºï¼Œèƒ½å¤Ÿå°†ä¸€ä¸ªå›¾åƒä¸­çš„å®ä¾‹å¤åˆ¶åˆ°å¦ä¸€ä¸ªå›¾åƒä¸­ï¼Œä»è€Œå¢åŠ æ•°æ®çš„å¤šæ ·æ€§ã€‚`Albumentations` ç±»åˆ™æä¾›äº†ä¸€ç³»åˆ—é¢å¤–çš„å›¾åƒå¢å¼ºå˜æ¢ï¼Œä½¿ç”¨äº† Albumentations åº“ã€‚

æœ€åï¼Œæ–‡ä»¶ä¸­è¿˜å®šä¹‰äº†ä¸€äº›ç”¨äºåˆ†ç±»ä»»åŠ¡çš„å˜æ¢å‡½æ•°ï¼Œå¦‚ `classify_transforms` å’Œ `classify_augmentations`ï¼Œè¿™äº›å‡½æ•°ä¸ºå›¾åƒåˆ†ç±»ä»»åŠ¡æä¾›äº†å¿…è¦çš„é¢„å¤„ç†å’Œå¢å¼ºã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶é€šè¿‡å®šä¹‰å¤šç§å›¾åƒå¢å¼ºå’Œé¢„å¤„ç†çš„ç±»å’Œæ–¹æ³•ï¼Œä¸º YOLO æ¨¡å‹çš„è®­ç»ƒæä¾›äº†çµæ´»çš„å›¾åƒå¤„ç†å·¥å…·ï¼Œæ—¨åœ¨æé«˜æ¨¡å‹çš„æ€§èƒ½å’Œé€‚åº”æ€§ã€‚

#### 11.4 code\ultralytics\models\sam\modules\tiny_encoder.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å¹¶æ·»åŠ è¯¦ç»†ä¸­æ–‡æ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

class Conv2d_BN(torch.nn.Sequential):
    """æ‰§è¡Œ2Då·ç§¯å¹¶éšåè¿›è¡Œæ‰¹é‡å½’ä¸€åŒ–çš„é¡ºåºå®¹å™¨ã€‚"""

    def __init__(self, in_channels, out_channels, kernel_size=1, stride=1, padding=0):
        """åˆå§‹åŒ–å·ç§¯å±‚å’Œæ‰¹é‡å½’ä¸€åŒ–å±‚ã€‚"""
        super().__init__()
        # æ·»åŠ å·ç§¯å±‚
        self.add_module("conv", nn.Conv2d(in_channels, out_channels, kernel_size, stride, padding, bias=False))
        # æ·»åŠ æ‰¹é‡å½’ä¸€åŒ–å±‚
        self.add_module("bn", nn.BatchNorm2d(out_channels))

class PatchEmbed(nn.Module):
    """å°†å›¾åƒåµŒå…¥ä¸ºè¡¥ä¸å¹¶æŠ•å½±åˆ°æŒ‡å®šçš„åµŒå…¥ç»´åº¦ã€‚"""

    def __init__(self, in_chans, embed_dim, resolution, activation):
        """åˆå§‹åŒ–è¡¥ä¸åµŒå…¥å±‚ã€‚"""
        super().__init__()
        self.patches_resolution = (resolution // 4, resolution // 4)  # è®¡ç®—è¡¥ä¸çš„åˆ†è¾¨ç‡
        self.seq = nn.Sequential(
            Conv2d_BN(in_chans, embed_dim // 2, kernel_size=3, stride=2, padding=1),
            activation(),
            Conv2d_BN(embed_dim // 2, embed_dim, kernel_size=3, stride=2, padding=1),
        )

    def forward(self, x):
        """é€šè¿‡è¡¥ä¸åµŒå…¥å±‚çš„åºåˆ—æ“ä½œå¤„ç†è¾“å…¥å¼ é‡ã€‚"""
        return self.seq(x)

class MBConv(nn.Module):
    """ç§»åŠ¨åå‘ç“¶é¢ˆå·ç§¯å±‚ï¼ŒEfficientNetæ¶æ„çš„ä¸€éƒ¨åˆ†ã€‚"""

    def __init__(self, in_chans, out_chans, expand_ratio, activation):
        """åˆå§‹åŒ–MBConvå±‚ã€‚"""
        super().__init__()
        self.conv1 = Conv2d_BN(in_chans, in_chans * expand_ratio, kernel_size=1)
        self.act1 = activation()
        self.conv2 = Conv2d_BN(in_chans * expand_ratio, in_chans * expand_ratio, kernel_size=3, padding=1, groups=in_chans * expand_ratio)
        self.act2 = activation()
        self.conv3 = Conv2d_BN(in_chans * expand_ratio, out_chans, kernel_size=1, bn_weight_init=0.0)
        self.act3 = activation()

    def forward(self, x):
        """å®ç°MBConvå±‚çš„å‰å‘ä¼ æ’­ã€‚"""
        shortcut = x  # æ®‹å·®è¿æ¥
        x = self.conv1(x)
        x = self.act1(x)
        x = self.conv2(x)
        x = self.act2(x)
        x = self.conv3(x)
        x += shortcut  # æ·»åŠ æ®‹å·®
        return self.act3(x)

class TinyViT(nn.Module):
    """TinyViTæ¶æ„ï¼Œç”¨äºè§†è§‰ä»»åŠ¡ã€‚"""

    def __init__(self, img_size=224, in_chans=3, num_classes=1000, embed_dims=[96, 192, 384, 768], depths=[2, 2, 6, 2]):
        """åˆå§‹åŒ–TinyViTæ¨¡å‹ã€‚"""
        super().__init__()
        self.patch_embed = PatchEmbed(in_chans=in_chans, embed_dim=embed_dims[0], resolution=img_size, activation=nn.GELU)
        self.layers = nn.ModuleList()
        for i_layer in range(len(depths)):
            layer = nn.ModuleList([MBConv(embed_dims[i_layer], embed_dims[i_layer], expand_ratio=4.0, activation=nn.GELU) for _ in range(depths[i_layer])])
            self.layers.append(layer)
        self.head = nn.Linear(embed_dims[-1], num_classes) if num_classes > 0 else nn.Identity()

    def forward(self, x):
        """æ‰§è¡Œå‰å‘ä¼ æ’­ã€‚"""
        x = self.patch_embed(x)  # è¾“å…¥ä¸º(N, C, H, W)
        for layer in self.layers:
            for block in layer:
                x = block(x)  # é€šè¿‡æ¯ä¸ªMBConvå—
        return self.head(x)  # æœ€ç»ˆåˆ†ç±»è¾“å‡º
```

### ä»£ç è¯´æ˜ï¼š
1. **Conv2d_BN**: è¿™ä¸ªç±»å®ç°äº†ä¸€ä¸ªåŒ…å«å·ç§¯å±‚å’Œæ‰¹é‡å½’ä¸€åŒ–å±‚çš„é¡ºåºå®¹å™¨ï¼Œæ–¹ä¾¿æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œã€‚
2. **PatchEmbed**: è¯¥ç±»å°†è¾“å…¥å›¾åƒåˆ†å‰²æˆè¡¥ä¸ï¼Œå¹¶é€šè¿‡å·ç§¯å±‚å°†å…¶åµŒå…¥åˆ°æŒ‡å®šçš„ç»´åº¦ã€‚
3. **MBConv**: è¿™æ˜¯ä¸€ä¸ªç§»åŠ¨åå‘ç“¶é¢ˆå·ç§¯å±‚ï¼Œä¸»è¦ç”¨äºé«˜æ•ˆçš„ç‰¹å¾æå–ï¼ŒåŒ…å«å¤šä¸ªå·ç§¯å’Œæ¿€æ´»å±‚ã€‚
4. **TinyViT**: è¿™æ˜¯æ•´ä¸ªæ¨¡å‹çš„æ ¸å¿ƒç±»ï¼Œè´Ÿè´£æ„å»ºTinyViTæ¶æ„ï¼ŒåŒ…æ‹¬è¡¥ä¸åµŒå…¥å’Œå¤šä¸ªMBConvå±‚ï¼Œæœ€ç»ˆè¾“å‡ºåˆ†ç±»ç»“æœã€‚

é€šè¿‡è¿™äº›æ ¸å¿ƒç»„ä»¶ï¼ŒTinyViTèƒ½å¤Ÿæœ‰æ•ˆåœ°å¤„ç†è§†è§‰ä»»åŠ¡ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `TinyViT` çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œä¸»è¦ç”¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚è¯¥æ¨¡å‹æ˜¯åŸºäº Transformer æ¶æ„çš„ï¼Œçµæ„Ÿæ¥æºäº LeViT å’Œ Swin Transformerï¼Œé‡‡ç”¨äº†ä¸€äº›åˆ›æ–°çš„è®¾è®¡æ¥æé«˜æ€§èƒ½å’Œæ•ˆç‡ã€‚

æ–‡ä»¶ä¸­é¦–å…ˆå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬ PyTorch å’Œç›¸å…³çš„æ¨¡å—ã€‚æ¥ç€å®šä¹‰äº†ä¸€äº›åŸºç¡€çš„ç»„ä»¶ç±»ï¼Œä¾‹å¦‚ `Conv2d_BN`ã€`PatchEmbed`ã€`MBConv`ã€`PatchMerging`ã€`ConvLayer`ã€`Mlp`ã€`Attention`ã€`TinyViTBlock`ã€`BasicLayer`ã€`LayerNorm2d` å’Œæœ€ç»ˆçš„ `TinyViT` ç±»ã€‚

`Conv2d_BN` ç±»æ˜¯ä¸€ä¸ªé¡ºåºå®¹å™¨ï¼Œæ‰§è¡ŒäºŒç»´å·ç§¯æ“ä½œå¹¶ç´§æ¥ç€è¿›è¡Œæ‰¹é‡å½’ä¸€åŒ–ã€‚`PatchEmbed` ç±»å°†è¾“å…¥å›¾åƒåµŒå…¥ä¸ºå°å—ï¼Œå¹¶å°†å…¶æŠ•å½±åˆ°æŒ‡å®šçš„åµŒå…¥ç»´åº¦ã€‚`MBConv` ç±»å®ç°äº†ç§»åŠ¨åå‘ç“¶é¢ˆå·ç§¯å±‚ï¼Œé€‚ç”¨äºé«˜æ•ˆçš„ç½‘ç»œæ¶æ„ã€‚`PatchMerging` ç±»åˆ™ç”¨äºåˆå¹¶ç‰¹å¾å›¾ä¸­çš„ç›¸é‚»å°å—å¹¶æŠ•å½±åˆ°æ–°çš„ç»´åº¦ã€‚

`ConvLayer` ç±»åŒ…å«å¤šä¸ª MBConv å±‚ï¼Œå¹¶æ”¯æŒè¾“å‡ºçš„ä¸‹é‡‡æ ·å’Œæ¢¯åº¦æ£€æŸ¥ç‚¹åŠŸèƒ½ã€‚`Mlp` ç±»å®ç°äº†å¤šå±‚æ„ŸçŸ¥æœºï¼Œç”¨äº Transformer æ¶æ„ä¸­çš„å‰é¦ˆç½‘ç»œã€‚`Attention` ç±»å®ç°äº†å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œæ”¯æŒç©ºé—´æ„ŸçŸ¥ï¼Œèƒ½å¤Ÿæ ¹æ®ç©ºé—´åˆ†è¾¨ç‡åº”ç”¨æ³¨æ„åŠ›åç½®ã€‚

`TinyViTBlock` ç±»æ˜¯ TinyViT çš„åŸºæœ¬æ„å»ºå—ï¼Œç»“åˆäº†è‡ªæ³¨æ„åŠ›å’Œå±€éƒ¨å·ç§¯æ“ä½œã€‚`BasicLayer` ç±»åˆ™æ˜¯ TinyViT ä¸­çš„ä¸€ä¸ªåŸºæœ¬å±‚ï¼ŒåŒ…å«å¤šä¸ª TinyViTBlockï¼Œå¹¶å¯é€‰æ‹©æ€§åœ°è¿›è¡Œä¸‹é‡‡æ ·ã€‚

`LayerNorm2d` ç±»å®ç°äº†äºŒç»´çš„å±‚å½’ä¸€åŒ–ã€‚æœ€åï¼Œ`TinyViT` ç±»æ˜¯æ•´ä¸ªæ¨¡å‹çš„æ ¸å¿ƒï¼Œè´Ÿè´£æ„å»ºæ¨¡å‹çš„å„ä¸ªå±‚ï¼ŒåŒ…æ‹¬å›¾åƒåµŒå…¥ã€å¤šä¸ªåŸºæœ¬å±‚ã€åˆ†ç±»å¤´ç­‰ã€‚å®ƒè¿˜å®ç°äº†æƒé‡åˆå§‹åŒ–å’Œå­¦ä¹ ç‡è¡°å‡çš„åŠŸèƒ½ã€‚

åœ¨ `TinyViT` çš„åˆå§‹åŒ–ä¸­ï¼Œç”¨æˆ·å¯ä»¥æŒ‡å®šè¾“å…¥å›¾åƒçš„å¤§å°ã€è¾“å…¥é€šé“æ•°ã€åˆ†ç±»ç±»åˆ«æ•°ã€åµŒå…¥ç»´åº¦ã€æ¯å±‚çš„æ·±åº¦ã€æ³¨æ„åŠ›å¤´æ•°ã€çª—å£å¤§å°ç­‰å‚æ•°ã€‚è¿™ç§çµæ´»æ€§ä½¿å¾—æ¨¡å‹å¯ä»¥æ ¹æ®å…·ä½“ä»»åŠ¡è¿›è¡Œè°ƒæ•´ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶å®ç°äº†ä¸€ä¸ªé«˜æ•ˆçš„è§†è§‰ Transformer æ¨¡å‹ï¼Œåˆ©ç”¨äº†å¤šç§ç°ä»£æ·±åº¦å­¦ä¹ æŠ€æœ¯ï¼Œä»¥ä¾¿åœ¨è®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¸­å–å¾—æ›´å¥½çš„æ€§èƒ½ã€‚

#### 11.5 code\ultralytics\utils\metrics.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import numpy as np
import torch

def box_iou(box1, box2, eps=1e-7):
    """
    è®¡ç®—ä¸¤ä¸ªè¾¹ç•Œæ¡†çš„äº¤å¹¶æ¯”ï¼ˆIoUï¼‰ã€‚
    
    Args:
        box1 (torch.Tensor): å½¢çŠ¶ä¸º (N, 4) çš„å¼ é‡ï¼Œè¡¨ç¤º N ä¸ªè¾¹ç•Œæ¡†ã€‚
        box2 (torch.Tensor): å½¢çŠ¶ä¸º (M, 4) çš„å¼ é‡ï¼Œè¡¨ç¤º M ä¸ªè¾¹ç•Œæ¡†ã€‚
        eps (float, optional): é¿å…é™¤ä»¥é›¶çš„å°å€¼ã€‚é»˜è®¤ä¸º 1e-7ã€‚

    Returns:
        (torch.Tensor): å½¢çŠ¶ä¸º (N, M) çš„å¼ é‡ï¼ŒåŒ…å« box1 å’Œ box2 ä¸­æ¯å¯¹è¾¹ç•Œæ¡†çš„ IoU å€¼ã€‚
    """
    # å°† box1 å’Œ box2 çš„åæ ‡åˆ†å¼€
    (a1, a2), (b1, b2) = box1.unsqueeze(1).chunk(2, 2), box2.unsqueeze(0).chunk(2, 2)
    
    # è®¡ç®—äº¤é›†åŒºåŸŸ
    inter = (torch.min(a2, b2) - torch.max(a1, b1)).clamp_(0).prod(2)

    # è®¡ç®— IoU = äº¤é›† / (åŒºåŸŸ1 + åŒºåŸŸ2 - äº¤é›†)
    return inter / ((a2 - a1).prod(2) + (b2 - b1).prod(2) - inter + eps)

def bbox_iou(box1, box2, xywh=True, eps=1e-7):
    """
    è®¡ç®—è¾¹ç•Œæ¡†çš„äº¤å¹¶æ¯”ï¼ˆIoUï¼‰ã€‚
    
    Args:
        box1 (torch.Tensor): å½¢çŠ¶ä¸º (1, 4) çš„å¼ é‡ï¼Œè¡¨ç¤ºå•ä¸ªè¾¹ç•Œæ¡†ã€‚
        box2 (torch.Tensor): å½¢çŠ¶ä¸º (n, 4) çš„å¼ é‡ï¼Œè¡¨ç¤º n ä¸ªè¾¹ç•Œæ¡†ã€‚
        xywh (bool, optional): å¦‚æœä¸º Trueï¼Œè¾“å…¥æ¡†ä¸º (x, y, w, h) æ ¼å¼ï¼›å¦‚æœä¸º Falseï¼Œè¾“å…¥æ¡†ä¸º (x1, y1, x2, y2) æ ¼å¼ã€‚é»˜è®¤ä¸º Trueã€‚
        eps (float, optional): é¿å…é™¤ä»¥é›¶çš„å°å€¼ã€‚é»˜è®¤ä¸º 1e-7ã€‚

    Returns:
        (torch.Tensor): IoU å€¼ã€‚
    """
    # å°† (x, y, w, h) è½¬æ¢ä¸º (x1, y1, x2, y2) æ ¼å¼
    if xywh:
        (x1, y1, w1, h1), (x2, y2, w2, h2) = box1.chunk(4, -1), box2.chunk(4, -1)
        b1_x1, b1_x2, b1_y1, b1_y2 = x1 - w1 / 2, x1 + w1 / 2, y1 - h1 / 2, y1 + h1 / 2
        b2_x1, b2_x2, b2_y1, b2_y2 = x2 - w2 / 2, x2 + w2 / 2, y2 - h2 / 2, y2 + h2 / 2
    else:
        b1_x1, b1_y1, b1_x2, b1_y2 = box1.chunk(4, -1)
        b2_x1, b2_y1, b2_x2, b2_y2 = box2.chunk(4, -1)

    # è®¡ç®—äº¤é›†åŒºåŸŸ
    inter = (b1_x2.minimum(b2_x2) - b1_x1.maximum(b2_x1)).clamp_(0) * (
        b1_y2.minimum(b2_y2) - b1_y1.maximum(b2_y1)
    ).clamp_(0)

    # è®¡ç®—å¹¶é›†åŒºåŸŸ
    union = (b1_x2 - b1_x1) * (b1_y2 - b1_y1 + eps) + (b2_x2 - b2_x1) * (b2_y2 - b2_y1 + eps) - inter + eps

    # è¿”å› IoU å€¼
    return inter / union

def compute_ap(recall, precision):
    """
    è®¡ç®—å¹³å‡ç²¾åº¦ï¼ˆAPï¼‰ç»™å®šå¬å›ç‡å’Œç²¾åº¦æ›²çº¿ã€‚
    
    Args:
        recall (list): å¬å›ç‡æ›²çº¿ã€‚
        precision (list): ç²¾åº¦æ›²çº¿ã€‚

    Returns:
        (float): å¹³å‡ç²¾åº¦ã€‚
        (np.ndarray): ç²¾åº¦åŒ…ç»œæ›²çº¿ã€‚
        (np.ndarray): ä¿®æ”¹åçš„å¬å›ç‡æ›²çº¿ã€‚
    """
    # åœ¨å¼€å§‹å’Œç»“æŸå¤„æ·»åŠ å“¨å…µå€¼
    mrec = np.concatenate(([0.0], recall, [1.0]))
    mpre = np.concatenate(([1.0], precision, [0.0]))

    # è®¡ç®—ç²¾åº¦åŒ…ç»œ
    mpre = np.flip(np.maximum.accumulate(np.flip(mpre)))

    # è®¡ç®—æ›²çº¿ä¸‹é¢ç§¯
    x = np.linspace(0, 1, 101)  # 101 ç‚¹æ’å€¼
    ap = np.trapz(np.interp(x, mrec, mpre), x)  # ç§¯åˆ†

    return ap, mpre, mrec
```

### ä»£ç è¯´æ˜ï¼š
1. **box_iou**ï¼šè®¡ç®—ä¸¤ä¸ªè¾¹ç•Œæ¡†ä¹‹é—´çš„äº¤å¹¶æ¯”ï¼ˆIoUï¼‰ï¼Œè¾“å…¥ä¸ºä¸¤ä¸ªè¾¹ç•Œæ¡†çš„åæ ‡ï¼Œè¾“å‡ºä¸ºå®ƒä»¬çš„ IoU å€¼ã€‚
2. **bbox_iou**ï¼šè®¡ç®—å•ä¸ªè¾¹ç•Œæ¡†ä¸å¤šä¸ªè¾¹ç•Œæ¡†ä¹‹é—´çš„ IoUï¼Œæ”¯æŒä¸¤ç§è¾“å…¥æ ¼å¼ï¼ˆxywh å’Œ xyxyï¼‰ã€‚
3. **compute_ap**ï¼šè®¡ç®—ç»™å®šå¬å›ç‡å’Œç²¾åº¦æ›²çº¿çš„å¹³å‡ç²¾åº¦ï¼ˆAPï¼‰ï¼Œå¹¶è¿”å› AP å€¼åŠç›¸å…³æ›²çº¿ã€‚

è¿™äº›å‡½æ•°æ˜¯ç›®æ ‡æ£€æµ‹è¯„ä¼°ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºè®¡ç®—æ¨¡å‹é¢„æµ‹çš„å‡†ç¡®æ€§å’Œæ€§èƒ½ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºè®¡ç®—å’Œæ›´æ–°æ¨¡å‹éªŒè¯æŒ‡æ ‡çš„æ¨¡å—ï¼Œä¸»è¦ç”¨äºç›®æ ‡æ£€æµ‹å’Œåˆ†ç±»ä»»åŠ¡ã€‚æ–‡ä»¶ä¸­å®šä¹‰äº†å¤šä¸ªå‡½æ•°å’Œç±»ï¼Œæ¶µç›–äº†ä¸åŒçš„è¯„ä¼°æŒ‡æ ‡å’Œè®¡ç®—æ–¹æ³•ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬æ•°å­¦è®¡ç®—åº“ã€è­¦å‘Šå¤„ç†ã€è·¯å¾„å¤„ç†ã€ç»˜å›¾åº“å’Œæ·±åº¦å­¦ä¹ æ¡†æ¶PyTorchã€‚æ¥ç€ï¼Œå®šä¹‰äº†ä¸€äº›å¸¸é‡å’Œå‡½æ•°ï¼Œä¾‹å¦‚è®¡ç®—è¾¹ç•Œæ¡†ï¼ˆbounding boxï¼‰ä¹‹é—´çš„äº¤å¹¶æ¯”ï¼ˆIoUï¼‰å’Œå…¶ä»–ç›¸å…³æŒ‡æ ‡çš„å‡½æ•°ã€‚

åœ¨å‡½æ•°éƒ¨åˆ†ï¼Œ`bbox_ioa`å‡½æ•°è®¡ç®—ç»™å®šä¸¤ä¸ªè¾¹ç•Œæ¡†çš„äº¤é›†ä¸ç¬¬äºŒä¸ªæ¡†çš„é¢ç§¯çš„æ¯”å€¼ï¼Œ`box_iou`å‡½æ•°è®¡ç®—ä¸¤ä¸ªè¾¹ç•Œæ¡†ä¹‹é—´çš„IoUï¼Œ`bbox_iou`å‡½æ•°åˆ™æä¾›äº†å¤šç§IoUè®¡ç®—æ–¹å¼ï¼ŒåŒ…æ‹¬æ ‡å‡†IoUã€å¹¿ä¹‰IoUï¼ˆGIoUï¼‰ã€è·ç¦»IoUï¼ˆDIoUï¼‰å’Œå®Œæ•´IoUï¼ˆCIoUï¼‰ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ç”¨äºè®¡ç®—æ©è†œIoUå’Œå…³é”®ç‚¹ç›¸ä¼¼æ€§ï¼ˆOKSï¼‰çš„å‡½æ•°ã€‚

æ¥ä¸‹æ¥ï¼Œå®šä¹‰äº†ä¸€ä¸ª`ConfusionMatrix`ç±»ï¼Œç”¨äºè®¡ç®—å’Œæ›´æ–°æ··æ·†çŸ©é˜µã€‚è¯¥ç±»åŒ…å«åˆå§‹åŒ–æ–¹æ³•å’Œå¤„ç†åˆ†ç±»é¢„æµ‹å’Œæ£€æµ‹ç»“æœçš„æ–¹æ³•ã€‚å®ƒèƒ½å¤Ÿæ ¹æ®æ£€æµ‹ç»“æœå’ŒçœŸå®æ ‡ç­¾æ›´æ–°æ··æ·†çŸ©é˜µï¼Œå¹¶æä¾›å¯è§†åŒ–åŠŸèƒ½ã€‚

åœ¨åç»­éƒ¨åˆ†ï¼Œå®šä¹‰äº†ä¸€äº›ç”¨äºç»˜åˆ¶ç²¾ç¡®åº¦-å¬å›ç‡æ›²çº¿ã€æŒ‡æ ‡-ç½®ä¿¡åº¦æ›²çº¿çš„å‡½æ•°ï¼Œä»¥åŠè®¡ç®—å¹³å‡ç²¾åº¦ï¼ˆAPï¼‰å’Œæ¯ä¸ªç±»åˆ«çš„APçš„å‡½æ•°ã€‚`Metric`ç±»ç”¨äºè®¡ç®—YOLOv8æ¨¡å‹çš„è¯„ä¼°æŒ‡æ ‡ï¼ŒåŒ…æ‹¬ç²¾ç¡®åº¦ã€å¬å›ç‡å’Œå¹³å‡ç²¾åº¦ç­‰ã€‚

æœ€åï¼Œæ–‡ä»¶ä¸­è¿˜å®šä¹‰äº†å¤šä¸ªç±»ï¼Œå¦‚`DetMetrics`ã€`SegmentMetrics`ã€`PoseMetrics`å’Œ`ClassifyMetrics`ï¼Œè¿™äº›ç±»åˆ†åˆ«ç”¨äºè®¡ç®—ä¸åŒä»»åŠ¡çš„æŒ‡æ ‡ï¼ŒåŒ…æ‹¬ç›®æ ‡æ£€æµ‹ã€åˆ†å‰²ã€å§¿æ€ä¼°è®¡å’Œåˆ†ç±»ã€‚æ¯ä¸ªç±»éƒ½åŒ…å«å¤„ç†é¢„æµ‹ç»“æœçš„æ–¹æ³•ã€è®¡ç®—å¹³å‡å€¼çš„æ–¹æ³•ã€è¿”å›æŒ‡æ ‡çš„å­—å…¸ç­‰åŠŸèƒ½ã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªæ¨¡å—ä¸ºYOLOæ¨¡å‹çš„è¯„ä¼°æä¾›äº†å…¨é¢çš„æ”¯æŒï¼Œèƒ½å¤Ÿè®¡ç®—å¤šç§æŒ‡æ ‡å¹¶ç”Ÿæˆç›¸åº”çš„å¯è§†åŒ–ç»“æœï¼Œä¾¿äºå¼€å‘è€…åˆ†ææ¨¡å‹æ€§èƒ½ã€‚

#### 11.6 code\ultralytics\engine\model.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class Model(nn.Module):
    """
    ç»Ÿä¸€æ‰€æœ‰æ¨¡å‹APIçš„åŸºç¡€ç±»ã€‚

    å‚æ•°:
        model (str, Path): è¦åŠ è½½æˆ–åˆ›å»ºçš„æ¨¡å‹æ–‡ä»¶è·¯å¾„ã€‚
        task (Any, optional): YOLOæ¨¡å‹çš„ä»»åŠ¡ç±»å‹ã€‚é»˜è®¤ä¸ºNoneã€‚

    å±æ€§:
        predictor (Any): é¢„æµ‹å™¨å¯¹è±¡ã€‚
        model (Any): æ¨¡å‹å¯¹è±¡ã€‚
        task (str): æ¨¡å‹ä»»åŠ¡ç±»å‹ã€‚
        ckpt (Any): å¦‚æœæ¨¡å‹æ˜¯ä»*.ptæ–‡ä»¶åŠ è½½çš„æ£€æŸ¥ç‚¹å¯¹è±¡ã€‚
        cfg (str): å¦‚æœä»*.yamlæ–‡ä»¶åŠ è½½çš„æ¨¡å‹é…ç½®ã€‚
    """

    def __init__(self, model: Union[str, Path] = "yolov8n.pt", task=None, verbose=False) -> None:
        """
        åˆå§‹åŒ–YOLOæ¨¡å‹ã€‚

        å‚æ•°:
            model (Union[str, Path], optional): è¦åŠ è½½æˆ–åˆ›å»ºçš„æ¨¡å‹è·¯å¾„æˆ–åç§°ã€‚é»˜è®¤ä¸º'yolov8n.pt'ã€‚
            task (Any, optional): YOLOæ¨¡å‹çš„ä»»åŠ¡ç±»å‹ã€‚é»˜è®¤ä¸ºNoneã€‚
            verbose (bool, optional): æ˜¯å¦å¯ç”¨è¯¦ç»†æ¨¡å¼ã€‚
        """
        super().__init__()
        self.predictor = None  # é¢„æµ‹å™¨å¯¹è±¡
        self.model = None  # æ¨¡å‹å¯¹è±¡
        self.task = task  # ä»»åŠ¡ç±»å‹
        self.model_name = model = str(model).strip()  # å»é™¤æ¨¡å‹åç§°çš„ç©ºæ ¼

        # æ£€æŸ¥æ˜¯å¦ä¸ºUltralytics HUBæ¨¡å‹
        if self.is_hub_model(model):
            self.session = self._get_hub_session(model)  # è·å–HUBä¼šè¯
            model = self.session.model_file  # ä»HUBè·å–æ¨¡å‹æ–‡ä»¶

        # åŠ è½½æˆ–åˆ›å»ºæ–°çš„YOLOæ¨¡å‹
        model = checks.check_model_file_from_stem(model)  # æ£€æŸ¥æ¨¡å‹æ–‡ä»¶åç¼€
        if Path(model).suffix in (".yaml", ".yml"):
            self._new(model, task=task, verbose=verbose)  # ä»é…ç½®æ–‡ä»¶åˆ›å»ºæ–°æ¨¡å‹
        else:
            self._load(model, task=task)  # ä»æƒé‡æ–‡ä»¶åŠ è½½æ¨¡å‹

        self.model_name = model  # æ›´æ–°æ¨¡å‹åç§°

    def predict(self, source=None, stream=False, predictor=None, **kwargs):
        """
        ä½¿ç”¨YOLOæ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚

        å‚æ•°:
            source (str | int | PIL | np.ndarray): è¦è¿›è¡Œé¢„æµ‹çš„å›¾åƒæºã€‚
            stream (bool): æ˜¯å¦æµå¼ä¼ è¾“é¢„æµ‹ç»“æœã€‚é»˜è®¤ä¸ºFalseã€‚
            predictor (BasePredictor): è‡ªå®šä¹‰é¢„æµ‹å™¨ã€‚
            **kwargs : ä¼ é€’ç»™é¢„æµ‹å™¨çš„å…¶ä»–å…³é”®å­—å‚æ•°ã€‚

        è¿”å›:
            (List[ultralytics.engine.results.Results]): é¢„æµ‹ç»“æœåˆ—è¡¨ã€‚
        """
        if source is None:
            source = ASSETS  # å¦‚æœæ²¡æœ‰æä¾›æºï¼Œåˆ™ä½¿ç”¨é»˜è®¤èµ„äº§
            LOGGER.warning(f"WARNING âš ï¸ 'source' is missing. Using 'source={source}'.")

        # æ£€æŸ¥æ˜¯å¦ä¸ºå‘½ä»¤è¡Œæ¥å£
        is_cli = (sys.argv[0].endswith("yolo") or sys.argv[0].endswith("ultralytics")) and any(
            x in sys.argv for x in ("predict", "track", "mode=predict", "mode=track")
        )

        custom = {"conf": 0.25, "save": is_cli}  # æ–¹æ³•é»˜è®¤å‚æ•°
        args = {**self.overrides, **custom, **kwargs, "mode": "predict"}  # åˆå¹¶å‚æ•°
        if not self.predictor:
            self.predictor = predictor or self._smart_load("predictor")(overrides=args, _callbacks=self.callbacks)
            self.predictor.setup_model(model=self.model, verbose=is_cli)  # è®¾ç½®æ¨¡å‹
        return self.predictor.predict_cli(source=source) if is_cli else self.predictor(source=source, stream=stream)

    @staticmethod
    def is_hub_model(model):
        """æ£€æŸ¥æä¾›çš„æ¨¡å‹æ˜¯å¦ä¸ºHUBæ¨¡å‹ã€‚"""
        return any(
            (
                model.startswith(f"{HUB_WEB_ROOT}/models/"),  # æ£€æŸ¥æ˜¯å¦ä¸ºHUBæ¨¡å‹URL
                [len(x) for x in model.split("_")] == [42, 20],  # æ£€æŸ¥APIKEY_MODELIDæ ¼å¼
                len(model) == 20 and not Path(model).exists() and all(x not in model for x in "./\\"),  # æ£€æŸ¥MODELIDæ ¼å¼
            )
        )

    def _load(self, weights: str, task=None):
        """
        ä»æƒé‡æ–‡ä»¶åŠ è½½æ¨¡å‹å¹¶æ¨æ–­ä»»åŠ¡ç±»å‹ã€‚

        å‚æ•°:
            weights (str): è¦åŠ è½½çš„æ¨¡å‹æ£€æŸ¥ç‚¹ã€‚
            task (str | None): æ¨¡å‹ä»»åŠ¡ã€‚
        """
        suffix = Path(weights).suffix
        if suffix == ".pt":
            self.model, self.ckpt = attempt_load_one_weight(weights)  # åŠ è½½æƒé‡
            self.task = self.model.args["task"]  # è·å–ä»»åŠ¡ç±»å‹
        else:
            weights = checks.check_file(weights)  # æ£€æŸ¥æ–‡ä»¶
            self.model, self.ckpt = weights, None
            self.task = task or guess_model_task(weights)  # æ¨æ–­ä»»åŠ¡ç±»å‹
        self.overrides["model"] = weights  # æ›´æ–°è¦†ç›–å‚æ•°
        self.overrides["task"] = self.task  # æ›´æ–°ä»»åŠ¡ç±»å‹

    def _new(self, cfg: str, task=None, model=None, verbose=False):
        """
        ä»é…ç½®æ–‡ä»¶åˆå§‹åŒ–æ–°æ¨¡å‹å¹¶æ¨æ–­ä»»åŠ¡ç±»å‹ã€‚

        å‚æ•°:
            cfg (str): æ¨¡å‹é…ç½®æ–‡ä»¶ã€‚
            task (str | None): æ¨¡å‹ä»»åŠ¡ã€‚
            model (BaseModel): è‡ªå®šä¹‰æ¨¡å‹ã€‚
            verbose (bool): åŠ è½½æ—¶æ˜¾ç¤ºæ¨¡å‹ä¿¡æ¯ã€‚
        """
        cfg_dict = yaml_model_load(cfg)  # åŠ è½½yamlé…ç½®
        self.cfg = cfg
        self.task = task or guess_model_task(cfg_dict)  # æ¨æ–­ä»»åŠ¡ç±»å‹
        self.model = (model or self._smart_load("model"))(cfg_dict, verbose=verbose)  # åˆ›å»ºæ¨¡å‹
        self.model.args = {**DEFAULT_CFG_DICT, **self.overrides}  # åˆå¹¶é»˜è®¤å‚æ•°å’Œæ¨¡å‹å‚æ•°
        self.model.task = self.task  # è®¾ç½®ä»»åŠ¡ç±»å‹
```

### ä¸»è¦åŠŸèƒ½æ¦‚è¿°
1. **æ¨¡å‹åˆå§‹åŒ–**ï¼š`__init__`æ–¹æ³•ç”¨äºåˆå§‹åŒ–YOLOæ¨¡å‹ï¼Œæ”¯æŒä»HUBåŠ è½½æ¨¡å‹ã€ä»æƒé‡æ–‡ä»¶åŠ è½½æ¨¡å‹æˆ–ä»é…ç½®æ–‡ä»¶åˆ›å»ºæ–°æ¨¡å‹ã€‚
2. **é¢„æµ‹åŠŸèƒ½**ï¼š`predict`æ–¹æ³•ç”¨äºæ‰§è¡Œé¢„æµ‹ï¼Œæ”¯æŒå¤šç§è¾“å…¥æºï¼Œè¿”å›é¢„æµ‹ç»“æœã€‚
3. **æ¨¡å‹åŠ è½½**ï¼š`_load`å’Œ`_new`æ–¹æ³•åˆ†åˆ«ç”¨äºä»æƒé‡æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶åŠ è½½æ¨¡å‹ï¼Œæ¨æ–­ä»»åŠ¡ç±»å‹ã€‚
4. **HUBæ¨¡å‹æ£€æŸ¥**ï¼š`is_hub_model`æ–¹æ³•ç”¨äºæ£€æŸ¥ç»™å®šçš„æ¨¡å‹æ˜¯å¦ä¸ºHUBæ¨¡å‹ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `Model` çš„ç±»ï¼Œä¸»è¦ç”¨äºç»Ÿä¸€ä¸åŒ YOLO æ¨¡å‹çš„ APIã€‚è¯¥ç±»ç»§æ‰¿è‡ª PyTorch çš„ `nn.Module`ï¼Œå¹¶æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•å’Œå±æ€§æ¥åŠ è½½ã€è®­ç»ƒã€é¢„æµ‹å’Œå¯¼å‡ºæ¨¡å‹ã€‚

åœ¨åˆå§‹åŒ–æ–¹æ³• `__init__` ä¸­ï¼Œç”¨æˆ·å¯ä»¥æŒ‡å®šæ¨¡å‹çš„è·¯å¾„æˆ–åç§°ã€ä»»åŠ¡ç±»å‹å’Œæ˜¯å¦å¯ç”¨è¯¦ç»†æ¨¡å¼ã€‚æ„é€ å‡½æ•°ä¼šæ£€æŸ¥æ¨¡å‹æ˜¯å¦æ¥è‡ª Ultralytics HUB æˆ– Triton Serverï¼Œå¹¶æ ¹æ®æ–‡ä»¶åç¼€åŠ è½½æ¨¡å‹æˆ–åˆ›å»ºæ–°æ¨¡å‹ã€‚å¦‚æœæ¨¡å‹æ˜¯ YAML é…ç½®æ–‡ä»¶ï¼Œåˆ™è°ƒç”¨ `_new` æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼›å¦‚æœæ˜¯æƒé‡æ–‡ä»¶ï¼Œåˆ™è°ƒç”¨ `_load` æ–¹æ³•åŠ è½½æ¨¡å‹ã€‚

`__call__` æ–¹æ³•æ˜¯å¯¹ `predict` æ–¹æ³•çš„åˆ«åï¼Œå…è®¸ç”¨æˆ·é€šè¿‡è°ƒç”¨æ¨¡å‹å®ä¾‹æ¥è¿›è¡Œé¢„æµ‹ã€‚ç±»ä¸­è¿˜å®šä¹‰äº†ä¸€äº›é™æ€æ–¹æ³•ï¼Œå¦‚ `_get_hub_session` ç”¨äºåˆ›å»º HUB è®­ç»ƒä¼šè¯ï¼Œ`is_triton_model` å’Œ `is_hub_model` ç”¨äºæ£€æŸ¥æ¨¡å‹æ˜¯å¦ä¸º Triton Server æˆ– HUB æ¨¡å‹ã€‚

`_new` å’Œ `_load` æ–¹æ³•åˆ†åˆ«ç”¨äºåˆå§‹åŒ–æ–°æ¨¡å‹å’ŒåŠ è½½å·²æœ‰æ¨¡å‹ã€‚`_check_is_pytorch_model` æ–¹æ³•ç¡®ä¿å½“å‰æ¨¡å‹æ˜¯ PyTorch æ¨¡å‹ã€‚`reset_weights` æ–¹æ³•å¯ä»¥é‡ç½®æ¨¡å‹çš„å‚æ•°ï¼Œè€Œ `load` æ–¹æ³•åˆ™ç”¨äºåŠ è½½æƒé‡ã€‚

`info` æ–¹æ³•ç”¨äºè®°å½•æ¨¡å‹ä¿¡æ¯ï¼Œ`fuse` æ–¹æ³•ç”¨äºèåˆæ¨¡å‹çš„å·ç§¯å±‚å’Œæ‰¹å½’ä¸€åŒ–å±‚ä»¥åŠ é€Ÿæ¨ç†ã€‚`embed` æ–¹æ³•ç”¨äºè·å–å›¾åƒåµŒå…¥ï¼Œ`predict` æ–¹æ³•æ‰§è¡Œé¢„æµ‹å¹¶è¿”å›ç»“æœã€‚`track` æ–¹æ³•ç”¨äºåœ¨è¾“å…¥æºä¸Šæ‰§è¡Œå¯¹è±¡è·Ÿè¸ªã€‚

`val` æ–¹æ³•ç”¨äºåœ¨ç»™å®šæ•°æ®é›†ä¸ŠéªŒè¯æ¨¡å‹ï¼Œ`benchmark` æ–¹æ³•ç”¨äºå¯¹æ¨¡å‹åœ¨æ‰€æœ‰å¯¼å‡ºæ ¼å¼ä¸Šçš„æ€§èƒ½è¿›è¡ŒåŸºå‡†æµ‹è¯•ã€‚`export` æ–¹æ³•ç”¨äºå¯¼å‡ºæ¨¡å‹ï¼Œ`train` æ–¹æ³•ç”¨äºåœ¨ç»™å®šæ•°æ®é›†ä¸Šè®­ç»ƒæ¨¡å‹ã€‚

`_apply` æ–¹æ³•ç”¨äºå°†æ¨¡å‹è¿ç§»åˆ°æŒ‡å®šè®¾å¤‡ï¼Œ`names`ã€`device` å’Œ `transforms` å±æ€§åˆ†åˆ«è¿”å›æ¨¡å‹çš„ç±»åã€è®¾å¤‡å’Œå˜æ¢ã€‚`add_callback`ã€`clear_callback` å’Œ `reset_callbacks` æ–¹æ³•ç”¨äºç®¡ç†å›è°ƒå‡½æ•°ã€‚

æœ€åï¼Œ`_smart_load` æ–¹æ³•ç”¨äºåŠ è½½æ¨¡å‹ã€è®­ç»ƒå™¨ã€éªŒè¯å™¨å’Œé¢„æµ‹å™¨ï¼Œè€Œ `task_map` å±æ€§åˆ™ç”¨äºå°†ä»»åŠ¡æ˜ å°„åˆ°ç›¸åº”çš„æ¨¡å‹ã€è®­ç»ƒå™¨ã€éªŒè¯å™¨å’Œé¢„æµ‹å™¨ç±»ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªç±»æä¾›äº†ä¸€ä¸ªå…¨é¢çš„æ¥å£ï¼Œæ–¹ä¾¿ç”¨æˆ·å¯¹ YOLO æ¨¡å‹è¿›è¡Œå„ç§æ“ä½œï¼ŒåŒ…æ‹¬åŠ è½½ã€è®­ç»ƒã€é¢„æµ‹å’Œå¯¼å‡ºç­‰ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ„æ¶æ¦‚æ‹¬

Ultralytics YOLO æ¡†æ¶æ˜¯ä¸€ä¸ªç”¨äºç›®æ ‡æ£€æµ‹å’Œè®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚å®ƒçš„æ•´ä½“åŠŸèƒ½åŒ…æ‹¬æ¨¡å‹çš„å®šä¹‰ã€è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹ã€æ•°æ®å¢å¼ºå’Œè¯„ä¼°ç­‰ã€‚æ¡†æ¶é‡‡ç”¨äº†æ¨¡å—åŒ–è®¾è®¡ï¼Œå„ä¸ªåŠŸèƒ½æ¨¡å—é€šè¿‡ç±»å’Œå‡½æ•°è¿›è¡Œç»„ç»‡ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤ã€‚

- **æ¨¡å‹å®šä¹‰**ï¼šé€šè¿‡ `model.py` æ–‡ä»¶å®šä¹‰äº† YOLO æ¨¡å‹çš„ç»“æ„å’ŒåŠŸèƒ½ï¼ŒåŒ…æ‹¬åŠ è½½ã€è®­ç»ƒå’Œé¢„æµ‹ã€‚
- **æ•°æ®å¤„ç†**ï¼š`augment.py` æ–‡ä»¶æä¾›äº†å¤šç§æ•°æ®å¢å¼ºæ–¹æ³•ï¼Œä»¥æé«˜æ¨¡å‹çš„é²æ£’æ€§ã€‚
- **å›è°ƒæœºåˆ¶**ï¼š`base.py` å’Œ `neptune.py` æ–‡ä»¶å®ç°äº†å›è°ƒæœºåˆ¶ï¼Œå…è®¸åœ¨è®­ç»ƒå’ŒéªŒè¯è¿‡ç¨‹ä¸­æ’å…¥è‡ªå®šä¹‰é€»è¾‘ã€‚
- **è¯„ä¼°æŒ‡æ ‡**ï¼š`metrics.py` æ–‡ä»¶æä¾›äº†è®¡ç®—å’Œæ›´æ–°æ¨¡å‹è¯„ä¼°æŒ‡æ ‡çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ··æ·†çŸ©é˜µã€ç²¾ç¡®åº¦ã€å¬å›ç‡ç­‰ã€‚
- **ç”¨æˆ·ç•Œé¢**ï¼š`ui.py` æ–‡ä»¶ç”¨äºå¯åŠ¨ Streamlit åº”ç”¨ï¼Œæä¾›å¯è§†åŒ–ç•Œé¢ã€‚
- **æ•°æ®æ¢ç´¢**ï¼š`explorer.py` æ–‡ä»¶ç”¨äºæ•°æ®é›†çš„å¯è§†åŒ–å’Œæ¢ç´¢ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£æ•°æ®ã€‚
- **æ¨¡å‹å¯¼å‡º**ï¼š`exporter.py` æ–‡ä»¶å®ç°äº†æ¨¡å‹çš„å¯¼å‡ºåŠŸèƒ½ï¼Œä»¥ä¾¿äºåœ¨ä¸åŒå¹³å°ä¸Šéƒ¨ç½²ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½æè¿° |
|----------|----------|
| `code/ultralytics/utils/callbacks/base.py` | å®šä¹‰äº†å›è°ƒå‡½æ•°çš„åŸºç±»å’Œå¤šç§å›è°ƒæœºåˆ¶ï¼Œç”¨äºè®­ç»ƒã€éªŒè¯å’Œé¢„æµ‹è¿‡ç¨‹ä¸­çš„è‡ªå®šä¹‰é€»è¾‘ã€‚ |
| `ui.py` | å¯åŠ¨ä¸€ä¸ª Streamlit åº”ç”¨ï¼Œæä¾›å¯è§†åŒ–ç•Œé¢ä»¥ä¾¿äºç”¨æˆ·ä¸æ¨¡å‹äº¤äº’ã€‚ |
| `code/ultralytics/data/augment.py` | æä¾›å¤šç§å›¾åƒå¢å¼ºå’Œé¢„å¤„ç†æ–¹æ³•ï¼Œä»¥æé«˜æ¨¡å‹çš„é²æ£’æ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚ |
| `code/ultralytics/models/sam/modules/tiny_encoder.py` | å®šä¹‰äº†åŸºäº Transformer çš„ TinyViT æ¨¡å‹ï¼Œç”¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚ |
| `code/ultralytics/utils/metrics.py` | è®¡ç®—å’Œæ›´æ–°æ¨¡å‹è¯„ä¼°æŒ‡æ ‡ï¼ŒåŒ…æ‹¬ IoUã€æ··æ·†çŸ©é˜µã€ç²¾ç¡®åº¦ã€å¬å›ç‡ç­‰ã€‚ |
| `code/ultralytics/engine/model.py` | å®šä¹‰äº† YOLO æ¨¡å‹çš„æ ¸å¿ƒç±»ï¼Œæä¾›åŠ è½½ã€è®­ç»ƒã€é¢„æµ‹å’Œå¯¼å‡ºç­‰åŠŸèƒ½ã€‚ |
| `code/ultralytics/utils/callbacks/neptune.py` | é›†æˆ Neptune è¿›è¡Œå®éªŒè·Ÿè¸ªå’Œå¯è§†åŒ–ï¼Œæ”¯æŒæ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­çš„ç›‘æ§ã€‚ |
| `code/ultralytics/data/explorer/explorer.py` | æä¾›æ•°æ®é›†çš„å¯è§†åŒ–å’Œæ¢ç´¢åŠŸèƒ½ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£æ•°æ®åˆ†å¸ƒå’Œç‰¹å¾ã€‚ |
| `code/ultralytics/data/build.py` | å¤„ç†æ•°æ®é›†çš„æ„å»ºå’Œé¢„å¤„ç†ï¼Œå‡†å¤‡è®­ç»ƒæ‰€éœ€çš„æ•°æ®æ ¼å¼ã€‚ |
| `code/ultralytics/engine/exporter.py` | å®ç°æ¨¡å‹çš„å¯¼å‡ºåŠŸèƒ½ï¼Œä»¥ä¾¿äºåœ¨ä¸åŒå¹³å°ä¸Šè¿›è¡Œéƒ¨ç½²å’Œæ¨ç†ã€‚ |
| `train.py` | å¯åŠ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ï¼Œé…ç½®è®­ç»ƒå‚æ•°å¹¶ç®¡ç†è®­ç»ƒå¾ªç¯ã€‚ |
| `code/ultralytics/utils/atss.py` | å®ç° ATSSï¼ˆAdaptive Training Sample Selectionï¼‰ç®—æ³•ï¼Œä¼˜åŒ–ç›®æ ‡æ£€æµ‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚ |

è¿™ä¸ªè¡¨æ ¼æ€»ç»“äº†æ¯ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå±•ç¤ºäº† Ultralytics YOLO æ¡†æ¶çš„æ¨¡å—åŒ–è®¾è®¡å’Œå„ä¸ªéƒ¨åˆ†çš„ç›¸äº’å…³ç³»ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/ZpuZmZpt](https://mbd.pub/o/bread/ZpuZmZpt)